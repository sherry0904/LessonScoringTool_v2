import{f as F,g as L,C as U,D as j,r as f,h as q,i as h,u as z,c as _,l as a,o as c,a as t,b as r,d as v,n as A,t as u,F as E,p as H,E as I,w as P,e as R,G,q as J,k as g,v as k,j as K,s as O,y as Q,H as W}from"#entry";const X={key:0,class:"min-h-screen bg-base-200"},Y={class:"bg-base-100 shadow-sm sticky top-0 z-10"},Z={class:"container mx-auto px-4 py-4"},tt={class:"flex justify-between items-center"},st={class:"flex items-center gap-4"},et={class:"text-2xl font-bold text-base-content"},nt={class:"text-sm text-base-content/70"},at={class:"flex gap-2"},ot={class:"tabs tabs-bordered mt-4"},lt=["href","onClick"],it={class:"container mx-auto px-4 py-6"},dt={class:"modal-box"},ct={class:"text-lg font-bold mb-4"},rt={class:"form-control"},ut=["disabled"],mt={class:"form-control"},bt={class:"modal-action"},pt={type:"submit",class:"btn btn-primary"},_t={key:1,class:"min-h-screen flex items-center justify-center"},vt={class:"text-center"},ht=F({__name:"[id]",setup(xt){const m=L(),y=U(),{currentClass:n}=j(m),b=f(),o=f(null),e=q({id:"",name:""}),C=h(()=>{const l=y.params.id;return[{id:"scoring",label:"個人計分",icon:"Star",path:`/class/${l}`},{id:"grouping",label:"分組模式",icon:"Users",path:`/class/${l}/grouping`},{id:"grades",label:"成績結算",icon:"BarChart3",path:`/class/${l}/grades`}]}),x=()=>{O("/")},S=()=>{o.value=null,e.id="",e.name="",b.value?.showModal()},w=l=>{const s=n.value?.students.find(d=>d.id===l);s&&(o.value=l,e.id=s.id,e.name=s.name,b.value?.showModal())},M=()=>{if(!e.id.trim()||!e.name.trim()){alert("座號和姓名不能為空！");return}if(n.value){if(o.value)m.updateStudent(n.value.id,o.value,{name:e.name});else{if(n.value.students.some(s=>s.id===e.id)){alert("座號已存在！");return}m.addStudentToClass(n.value.id,e.name,e.id)}p()}},N=()=>{!o.value||!n.value||confirm("確定要刪除此學生嗎？")&&(m.removeStudentFromClass(n.value.id,o.value),p())},p=()=>{b.value?.close(),o.value=null};return z({title:h(()=>n.value?`${n.value.name} - 班級經營動力站`:"班級管理 - 班級經營動力站")}),W("editStudent",w),(l,s)=>{const d=A,T=R,V=G;return a(n)?(c(),_("div",X,[t("div",Y,[t("div",Z,[t("div",tt,[t("div",st,[t("button",{onClick:x,class:"btn btn-ghost btn-sm gap-2"},[r(d,{name:"ArrowLeft",class:"w-4 h-4"}),s[2]||(s[2]=v(" 返回總覽 ",-1))]),t("div",null,[t("h1",et,u(a(n).name),1),t("p",nt,u(a(n).students.length)+" 位學生 ",1)])]),t("div",at,[t("button",{onClick:S,class:"btn btn-primary btn-sm gap-2"},[r(d,{name:"UserPlus",class:"w-4 h-4"}),s[3]||(s[3]=v(" 新增學生 ",-1))])])]),t("div",ot,[(c(!0),_(E,null,H(a(C),i=>(c(),I(T,{key:i.id,to:i.path,custom:""},{default:P(({href:B,navigate:$,isExactActive:D})=>[t("a",{href:B,onClick:$,class:Q(["tab tab-lg",{"tab-active":D}])},[r(d,{name:i.icon,class:"w-4 h-4 mr-2"},null,8,["name"]),v(" "+u(i.label),1)],10,lt)]),_:2},1032,["to"]))),128))])])]),t("div",it,[r(V)]),t("dialog",{ref_key:"studentModal",ref:b,class:"modal"},[t("div",dt,[t("h3",ct,u(a(o)?"編輯學生":"新增學生"),1),t("form",{onSubmit:J(M,["prevent"]),class:"space-y-4"},[t("div",rt,[s[4]||(s[4]=t("label",{class:"label"},[t("span",{class:"label-text"},"座號")],-1)),g(t("input",{"onUpdate:modelValue":s[0]||(s[0]=i=>a(e).id=i),type:"text",placeholder:"例如：01",class:"input input-bordered",disabled:!!a(o),required:""},null,8,ut),[[k,a(e).id]])]),t("div",mt,[s[5]||(s[5]=t("label",{class:"label"},[t("span",{class:"label-text"},"姓名")],-1)),g(t("input",{"onUpdate:modelValue":s[1]||(s[1]=i=>a(e).name=i),type:"text",placeholder:"例如：王小明",class:"input input-bordered",required:""},null,512),[[k,a(e).name]])]),t("div",bt,[a(o)?(c(),_("button",{key:0,type:"button",onClick:N,class:"btn btn-error"}," 刪除學生 ")):K("",!0),t("button",{type:"button",onClick:p,class:"btn btn-ghost"}," 取消 "),t("button",pt,u(a(o)?"更新":"新增"),1)])],32)]),t("form",{method:"dialog",class:"modal-backdrop"},[t("button",{onClick:p},"close")])],512)])):(c(),_("div",_t,[t("div",vt,[r(d,{name:"AlertCircle",class:"w-16 h-16 mx-auto text-warning mb-4"}),s[6]||(s[6]=t("h2",{class:"text-xl font-semibold mb-2"},"找不到班級",-1)),s[7]||(s[7]=t("p",{class:"text-base-content/70 mb-4"},"請確認網址是否正確，或返回總覽頁面",-1)),t("button",{onClick:x,class:"btn btn-primary"},"返回班級總覽")])]))}}});export{ht as default};
