import{f as S,g as C,h as D,r as _,j as d,H as k,z as L,u as T,c as o,o as c,b as i,a as s,L as z,m as H,B as I,F as b,n as f,t as n,d as N,l as q,q as B,_ as M}from"#entry";import{f as V}from"./s03H60Zk.js";import{P as $}from"./CRH0BifM.js";const j={class:"p-6 max-w-7xl mx-auto space-y-8"},Q={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},U={class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3"},F={class:"relative"},K=["value"],O={class:"flex items-center gap-2"},P=["value"],Z={class:"bg-base-100 rounded-2xl border border-base-300 shadow-sm overflow-hidden"},E={class:"p-4 flex items-center justify-between border-b border-base-300"},X={class:"font-semibold flex items-center gap-2"},G={key:0,class:"max-h-[60vh] overflow-auto custom-scrollbar"},J={class:"table table-zebra"},R=["onClick"],W={class:"font-medium"},Y={class:"text-center font-mono"},ee={class:"hidden md:table-cell"},te={class:"hidden md:table-cell"},se={key:1,class:"p-10 text-center text-base-content/60"},ae={key:0},le={key:1},oe=S({__name:"students",setup(ce){const u=C(),p=D(),r=_(""),w=[{value:"nameAsc",label:"姓名 (A → Z)"},{value:"nameDesc",label:"姓名 (Z → A)"},{value:"idAsc",label:"座號 (小 → 大)"},{value:"idDesc",label:"座號 (大 → 小)"},{value:"scoreDesc",label:"總分 (高 → 低)"},{value:"scoreAsc",label:"總分 (低 → 高)"},{value:"createdDesc",label:"建立時間 (新 → 舊)"},{value:"createdAsc",label:"建立時間 (舊 → 新)"}],m=_("nameAsc"),x=t=>{r.value=t},v=d(()=>u.classes.flatMap(t=>(t.students||[]).map(e=>({id:e.id,name:e.name,totalScore:e.totalScore||0,classId:t.id,className:t.name,createdAt:new Date(e.createdAt),uniqueKey:`${t.id}-${e.id}`})))),g=d(()=>{const t=r.value.trim().toLowerCase();return t?v.value.filter(e=>e.name.toLowerCase().includes(t)||e.className.toLowerCase().includes(t)||e.id.toLowerCase().includes(t)):v.value}),h=d(()=>{const t=[...g.value];switch(m.value){case"nameAsc":return t.sort((e,a)=>e.name.localeCompare(a.name,"zh-Hant"));case"nameDesc":return t.sort((e,a)=>a.name.localeCompare(e.name,"zh-Hant"));case"idAsc":return t.sort((e,a)=>e.id.localeCompare(a.id,"zh-Hant",{numeric:!0}));case"idDesc":return t.sort((e,a)=>a.id.localeCompare(e.id,"zh-Hant",{numeric:!0}));case"scoreDesc":return t.sort((e,a)=>a.totalScore-e.totalScore);case"scoreAsc":return t.sort((e,a)=>e.totalScore-a.totalScore);case"createdAsc":return t.sort((e,a)=>e.createdAt.getTime()-a.createdAt.getTime());case"createdDesc":default:return t.sort((e,a)=>a.createdAt.getTime()-e.createdAt.getTime())}}),y=d(()=>v.value.length);d(()=>{const t=Date.now()-6048e5;return u.classes.filter(e=>new Date(e.updatedAt).getTime()>t).length}),d(()=>u.totalClasses?Math.round(y.value/u.totalClasses):0);const A=t=>{u.selectClass(t),B(`/class/${t}`)};return k(()=>{r.value=p.searchQuery||""}),L(r,t=>{p.setSearchQuery(t)}),T({title:"學生管理 - 班級分組計分工具"}),(t,e)=>{const a=z;return c(),o("div",j,[i($,{title:"學生管理",description:"跨班級檢視與管理所有學生"}),s("div",Q,[s("div",U,[s("div",F,[s("input",{value:r.value,onInput:e[0]||(e[0]=l=>x(l.target.value)),type:"text",placeholder:"搜尋學生、班級或座號...",class:"input input-bordered pl-10 w-full sm:w-72"},null,40,K),i(a,{name:"Search",class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-base-content/50"})]),s("div",O,[e[2]||(e[2]=s("label",{for:"student-sort",class:"text-sm font-semibold whitespace-nowrap"},"排序方式",-1)),H(s("select",{id:"student-sort","onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),class:"select select-bordered select-sm sm:select-md"},[(c(),o(b,null,f(w,l=>s("option",{key:l.value,value:l.value},n(l.label),9,P)),64))],512),[[I,m.value]])])])]),s("div",Z,[s("div",E,[s("h2",X,[i(a,{name:"List",class:"w-5 h-5"}),N(" 全部學生 ("+n(h.value.length)+") ",1)]),e[3]||(e[3]=s("div",{class:"text-sm text-base-content/60"},"點擊學生可快速跳轉至其班級頁面",-1))]),h.value.length?(c(),o("div",G,[s("table",J,[e[4]||(e[4]=s("thead",{class:"sticky top-0 bg-base-200 z-10"},[s("tr",null,[s("th",{class:"w-20"},"座號"),s("th",null,"姓名"),s("th",{class:"w-24 text-center"},"總分"),s("th",{class:"hidden md:table-cell"},"所屬班級"),s("th",{class:"hidden md:table-cell"},"建立時間")])],-1)),s("tbody",null,[(c(!0),o(b,null,f(h.value,l=>(c(),o("tr",{key:l.uniqueKey,class:"hover cursor-pointer",onClick:ne=>A(l.classId)},[s("td",null,n(l.id),1),s("td",W,n(l.name),1),s("td",Y,n(l.totalScore),1),s("td",ee,n(l.className),1),s("td",te,n(q(V)(l.createdAt)),1)],8,R))),128))])])])):(c(),o("div",se,[i(a,{name:"UserX",class:"w-10 h-10 mx-auto mb-4 opacity-50"}),r.value?(c(),o("p",ae,"找不到符合「"+n(r.value)+"」的學生",1)):(c(),o("p",le,"目前沒有任何學生資料"))]))])])}}}),ie=M(oe,[["__scopeId","data-v-fd1c8f40"]]);export{ie as default};
