import{f as le,s as ve,j as P,x as Z,c as u,o as d,a as e,b as v,L as z,y as Ve,t as i,r as k,z as O,k as R,F as j,d as x,A as B,m as E,B as he,n as te,l as H,_ as _e,i as Le,g as ye,R as se,v as Q,C as me,h as ze,D as xe,p as ue,T as Fe,E as be}from"#entry";import{P as Ge}from"./CRH0BifM.js";const Je=["data-tip"],Xe={class:"flex items-center gap-1.5"},We={class:"text-sm"},He=le({__name:"RewardBadge",props:{classInfo:{},showDetails:{type:Boolean,default:!1}},setup(q){const y=q,w=ve(),b=P(()=>y.classInfo.rewardSettingsMode==="template"&&y.classInfo.appliedRewardTemplateId&&w.getTemplateById(y.classInfo.appliedRewardTemplateId)?.settings||null),I=P(()=>y.classInfo.rewardSettingsMode==="disabled"?"å·²åœç”¨":y.classInfo.rewardSettingsMode==="template"&&y.classInfo.appliedRewardTemplateId?w.getTemplateById(y.classInfo.appliedRewardTemplateId)?.name||"ç¯„æœ¬":"æœªè¨­å®š"),T=P(()=>y.classInfo.rewardSettingsMode==="disabled"?"Ban":b.value?.mode==="class-total"?"Users":b.value?.mode==="group-based"?"Trophy":"AlertCircle"),f=P(()=>y.classInfo.rewardSettingsMode==="disabled"?"hsl(0, 84%, 60%)":b.value?.mode==="class-total"?"hsl(217, 91%, 60%)":b.value?.mode==="group-based"?"hsl(142, 76%, 36%)":"hsl(38, 92%, 50%)"),p=P(()=>b.value?b.value.mode==="group-based"?`å„çµ„ç¨ç«‹ï½œğŸ’° ${b.value.pointsPerStar}åˆ†=1æ˜Ÿ / â­ ${b.value.starsToInvincible}æ˜Ÿç„¡æ•µ / â±ï¸ ${Z(b.value.invincibleDurationSeconds)}`:b.value.mode==="class-total"?`å…¨ç­å”ä½œï½œğŸ¯ ${b.value.classTotalTargetPoints}åˆ†ç„¡æ•µ / â±ï¸ ${Z(b.value.invincibleDurationSeconds)}`:I.value:I.value);return(n,g)=>{const $=z;return d(),u("div",{class:"tooltip tooltip-bottom z-50","data-tip":p.value},[e("div",Xe,[v($,{name:T.value,class:"w-4 h-4 flex-shrink-0",style:Ve({color:f.value})},null,8,["name","style"]),e("span",We,i(I.value),1)])],8,Je)}}}),Ye=Object.assign(He,{__name:"RewardBadge"}),qe={class:"space-y-6"},Ke={key:0,class:"alert alert-warning"},Qe={class:"text-sm"},Ze={class:"text-xs mt-1"},es={class:"form-control"},ss={class:"flex flex-wrap items-center gap-2 bg-base-200/70 p-1.5 rounded-2xl mb-4",role:"tablist","aria-label":"çå‹µæ¨¡å¼åˆ‡æ›"},ts=["aria-selected"],ls=["aria-selected"],ns={class:"flex flex-col gap-3"},as={class:"flex items-start gap-3 flex-1"},os=["checked"],is={class:"flex items-start gap-3 flex-1"},rs=["checked"],ds={class:"flex-1"},cs={key:0,class:"mt-3"},us=["value"],ps={key:0,class:"mt-3 p-3 bg-base-200/50 rounded-lg text-xs"},bs={class:"font-semibold text-sm mb-2 flex items-center gap-2"},ms={key:0,class:"grid grid-cols-2 gap-x-4 gap-y-2"},vs={class:"flex items-center gap-2"},gs={class:"font-semibold"},fs={class:"flex items-center gap-2"},xs={class:"font-semibold"},hs={class:"flex items-center gap-2"},_s={class:"font-semibold"},ys={class:"flex items-center gap-2"},ws={class:"font-semibold"},Ts={key:1,class:"grid grid-cols-2 gap-x-4 gap-y-2"},ks={class:"flex items-center gap-2"},$s={class:"font-semibold"},Cs={class:"flex items-center gap-2"},Ss={class:"font-semibold"},Ms={class:"flex items-center gap-2"},Is={class:"font-semibold"},Ds={class:"flex gap-3 justify-between pt-4 border-t"},Ps={class:"flex gap-3"},Bs=["disabled"],Rs=le({__name:"RewardSettingsForm",props:{classInfo:{},templates:{}},emits:["save","cancel"],setup(q,{emit:y}){const w=q,b=y,I=ve(),T=k(w.classInfo.rewardSettingsMode==="custom"?"disabled":w.classInfo.rewardSettingsMode||"disabled"),f=k(w.classInfo.appliedRewardTemplateId||""),p=k("class-total");if(f.value){const _=I.getTemplateById(f.value);_?.settings.mode&&(p.value=_.settings.mode)}const n=P(()=>w.templates.filter(_=>_.settings.mode===p.value)),g=P(()=>f.value?I.getTemplateById(f.value):null),$=P(()=>T.value==="disabled"?!0:T.value==="template"?!!f.value:!1),D=()=>{$.value&&(T.value==="disabled"?b("save",{classId:w.classInfo.id,mode:"disabled"}):T.value==="template"&&b("save",{classId:w.classInfo.id,mode:"template",templateId:f.value}))};return O(T,_=>{_==="template"&&!f.value&&n.value.length>0&&(f.value=n.value[0].id)}),O(p,()=>{if(T.value==="template"){const _=g.value;_&&_.settings.mode!==p.value&&(n.value.length>0?f.value=n.value[0].id:f.value="")}}),(_,a)=>{const S=z;return d(),u("div",qe,[_.classInfo.groupingActive?(d(),u("div",Ke,[v(S,{name:"AlertCircle",class:"w-5 h-5 flex-shrink-0"}),e("div",Qe,[a[6]||(a[6]=e("div",{class:"font-semibold"},"âš ï¸ åˆ†çµ„æ´»å‹•é€²è¡Œä¸­",-1)),e("div",Ze,[g.value?.settings.mode==="class-total"?(d(),u(j,{key:0},[x(" æ–°è¨­å®šå°‡å¥—ç”¨åˆ°æ–°å¢çš„åˆ†æ•¸ã€‚å·²æ”¶é›†çš„ç¸½åˆ†ä¸æœƒé‡æ–°è¨ˆç®—ã€‚ ")],64)):(d(),u(j,{key:1},[x(" æ–°è¨­å®šå°‡å¥—ç”¨åˆ°æ–°å¢çš„åˆ†æ•¸ã€‚å·²æ”¶é›†çš„æ˜Ÿæ˜Ÿæ•¸ä¸æœƒé‡æ–°è¨ˆç®—ã€‚ ")],64))])])])):R("",!0),e("div",es,[a[21]||(a[21]=e("label",{class:"label"},[e("span",{class:"label-text font-semibold"},"çå‹µæ¨¡å¼")],-1)),e("div",ss,[e("button",{type:"button",role:"tab","aria-selected":p.value==="class-total",class:B(["flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-semibold transition-all border border-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-primary",{"bg-base-100 text-primary shadow-[0_6px_18px_rgba(25,39,85,0.15)] border-primary/20":p.value==="class-total","text-base-content/60 hover:text-base-content hover:bg-base-100/70":p.value!=="class-total"}]),onClick:a[0]||(a[0]=h=>p.value="class-total")},[v(S,{name:"Users",class:"w-4 h-4"}),a[7]||(a[7]=e("span",null,"å…¨ç­å”ä½œæ¨¡å¼",-1))],10,ts),e("button",{type:"button",role:"tab","aria-selected":p.value==="group-based",class:B(["flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-semibold transition-all border border-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-primary",{"bg-base-100 text-primary shadow-[0_6px_18px_rgba(25,39,85,0.15)] border-primary/20":p.value==="group-based","text-base-content/60 hover:text-base-content hover:bg-base-100/70":p.value!=="group-based"}]),onClick:a[1]||(a[1]=h=>p.value="group-based")},[v(S,{name:"Trophy",class:"w-4 h-4"}),a[8]||(a[8]=e("span",null,"å„çµ„ç¨ç«‹æ¨¡å¼",-1))],10,ls)]),e("div",ns,[e("label",{class:B(["cursor-pointer label border rounded-lg p-4 hover:bg-base-200/50 transition-colors",{"border-error bg-error/5":T.value==="disabled"}])},[e("div",as,[e("input",{type:"radio",class:"radio radio-error",checked:T.value==="disabled",onChange:a[2]||(a[2]=h=>T.value="disabled")},null,40,os),a[9]||(a[9]=e("div",{class:"flex-1"},[e("span",{class:"label-text font-semibold"},"åœç”¨çå‹µæ©Ÿåˆ¶"),e("p",{class:"text-xs text-base-content mt-1"},"ä¸ä½¿ç”¨ä»»ä½•çå‹µæ©Ÿåˆ¶")],-1))])],2),e("label",{class:B(["cursor-pointer label border rounded-lg p-4 hover:bg-base-200/50 transition-colors",{"border-success bg-success/5":T.value==="template"}])},[e("div",is,[e("input",{type:"radio",class:"radio radio-success",checked:T.value==="template",onChange:a[3]||(a[3]=h=>T.value="template")},null,40,rs),e("div",ds,[a[19]||(a[19]=e("span",{class:"label-text font-semibold"},"ä½¿ç”¨ç¯„æœ¬",-1)),a[20]||(a[20]=e("p",{class:"text-xs text-base-content mt-1"},"å¾é è¨­ç¯„æœ¬ä¸­é¸æ“‡",-1)),T.value==="template"?(d(),u("div",cs,[E(e("select",{"onUpdate:modelValue":a[4]||(a[4]=h=>f.value=h),class:"select select-bordered select-sm w-full text-base-content font-medium"},[a[10]||(a[10]=e("option",{value:"",class:"text-base-content"}," -- è«‹é¸æ“‡ç¯„æœ¬ -- ",-1)),(d(!0),u(j,null,te(n.value,h=>(d(),u("option",{key:h.id,value:h.id,class:"text-base-content"},i(h.name),9,us))),128))],512),[[he,f.value]]),g.value?(d(),u("div",ps,[e("div",bs,[v(S,{name:"Info",class:"w-4 h-4"}),a[11]||(a[11]=x(" è¨­å®šé è¦½ ",-1))]),g.value.settings.mode==="group-based"?(d(),u("div",ms,[e("div",vs,[a[12]||(a[12]=e("span",{class:"text-base-content"},"ğŸ’° æ¯æ˜Ÿ",-1)),e("span",gs,i(g.value.settings.pointsPerStar)+"åˆ†",1)]),e("div",fs,[a[13]||(a[13]=e("span",{class:"text-base-content"},"â­ ç„¡æ•µ",-1)),e("span",xs,i(g.value.settings.starsToInvincible)+"æ˜Ÿ",1)]),e("div",hs,[a[14]||(a[14]=e("span",{class:"text-base-content"},"â±ï¸ æ™‚é•·",-1)),e("span",_s,i(H(Z)(g.value.settings.invincibleDurationSeconds)),1)]),e("div",ys,[a[15]||(a[15]=e("span",{class:"text-base-content"},"ğŸ¯ åŠ åˆ†",-1)),e("span",ws,i(g.value.settings.invinciblePointsPerClick)+"åˆ†/æ¬¡",1)])])):g.value.settings.mode==="class-total"?(d(),u("div",Ts,[e("div",ks,[a[16]||(a[16]=e("span",{class:"text-base-content"},"ğŸ¯ å…¨ç­ç›®æ¨™",-1)),e("span",$s,i(g.value.settings.classTotalTargetPoints??g.value.settings.classTotalMode?.pointsPerInvincible)+"åˆ† ",1)]),e("div",Cs,[a[17]||(a[17]=e("span",{class:"text-base-content"},"â±ï¸ ç„¡æ•µæ™‚é•·",-1)),e("span",Ss,i(H(Z)(g.value.settings.invincibleDurationSeconds??g.value.settings.classTotalMode?.invincibleDurationSeconds)),1)]),e("div",Ms,[a[18]||(a[18]=e("span",{class:"text-base-content"},"ğŸ’ ç„¡æ•µåŠ åˆ†",-1)),e("span",Is,i(g.value.settings.invinciblePointsPerClick??g.value.settings.classTotalMode?.invinciblePointsPerClick)+"åˆ†/æ¬¡ ",1)])])):R("",!0)])):R("",!0)])):R("",!0)])])],2)])]),e("div",Ds,[a[23]||(a[23]=e("div",null,null,-1)),e("div",Ps,[e("button",{onClick:a[5]||(a[5]=h=>_.$emit("cancel")),class:"btn btn-ghost"},"å–æ¶ˆ"),e("button",{onClick:D,class:"btn btn-primary gap-2",disabled:!$.value},[v(S,{name:"Save",class:"w-4 h-4"}),a[22]||(a[22]=x(" å„²å­˜è¨­å®š ",-1))],8,Bs)])])])}}}),As=Object.assign(_e(Rs,[["__scopeId","data-v-f4b9d016"]]),{__name:"RewardSettingsForm"}),Ns={class:"modal-box w-full max-w-md"},js={class:"modal-title text-lg font-bold mb-6"},Us={key:0,class:"alert alert-warning gap-3 mb-6"},Es={class:"flex-1"},Os={class:"text-sm font-semibold leading-tight"},Vs={class:"text-xs text-warning/80 mt-1 leading-relaxed"},Ls={class:"list-disc list-inside ml-1"},zs={class:"space-y-6"},Fs={class:"form-control"},Gs={class:"bg-base-200/30 px-4 py-4 rounded-lg space-y-4"},Js={class:"font-semibold text-sm text-base-content/80 -mx-4 px-4"},Xs={class:"form-control -mx-4 px-4"},Ws={class:"label pb-1.5"},Hs={class:"label-text-alt text-xs text-black"},Ys=["disabled"],qs={key:0,class:"form-control -mx-4 px-4"},Ks={class:"form-control -mx-4 px-4"},Qs={class:"form-control -mx-4 px-4"},Zs={class:"form-control -mx-4 px-4"},et={class:"flex gap-2 items-center"},st={class:"flex-1"},tt={class:"flex-1"},lt={class:"form-control -mx-4 px-4"},nt={key:2,class:"border border-base-200 rounded-lg bg-base-100 px-4 py-4 space-y-4"},at={class:"flex items-center justify-between gap-3 -mx-4 px-4"},ot=["disabled"],it={key:0,class:"alert alert-warning -mx-4 px-4"},rt={class:"text-xs"},dt={class:"flex flex-col gap-3 -mx-4 px-4"},ct={class:"grid gap-4 items-center md:grid-cols-[auto,1fr,auto] sm:grid-cols-[auto,1fr] grid-cols-1"},ut={class:"flex flex-col gap-1"},pt={class:"flex items-center gap-2"},bt=["value","max","onInput"],mt={class:"flex flex-col gap-1"},vt={class:"flex items-center gap-2"},gt=["value","maxlength","onInput"],ft={class:"text-[10px] text-base-content/50"},xt={class:"flex items-center justify-end self-stretch"},ht=["onClick"],_t={class:"modal-action mt-8"},yt=le({__name:"RewardTemplateModal",props:{initialTemplate:{default:null},isCreatingNew:{type:Boolean,default:!1},defaultSettings:{default:void 0}},emits:["save","cancel"],setup(q,{expose:y,emit:w}){const b=q,I=w,T=k(null),f=k(b.isCreatingNew),p=()=>b.defaultSettings?JSON.parse(JSON.stringify(b.defaultSettings)):{enabled:!0,mode:"group-based",pointsPerStar:10,starsToInvincible:3,invincibleDurationSeconds:600,invinciblePointsPerClick:2,milestoneMessages:me(3)},n=Le({id:"",name:"æ–°çš„çå‹µç¯„æœ¬",settings:p(),isDefault:!1}),g=ye(),$=P(()=>{if(f.value||!n.id)return[];const r=[];return g.classes.forEach(t=>{t.rewardSettingsMode==="template"&&t.appliedRewardTemplateId===n.id&&t.groupingActive&&r.push({id:t.id,name:t.name})}),r}),D=P(()=>$.value.length>0),_=k(10),a=k(0),S=r=>{const t=Math.max(1,Math.floor(r.starsToInvincible||1)),C=(Array.isArray(r.milestoneMessages)?r.milestoneMessages:[]).map(A=>{const Y=Math.min(t,Math.max(1,Math.floor(Number(A?.threshold)||0))),re=typeof A?.message=="string"?A.message.trim().slice(0,se):"";return{threshold:Y,message:re}}).sort((A,Y)=>A.threshold-Y.threshold),M=[],J=new Map;return C.forEach(A=>{if(J.has(A.threshold)){const Y=J.get(A.threshold);M[Y]=A}else J.set(A.threshold,M.length),M.push(A)}),r.milestoneMessages=M,r},h=P({get:()=>S(n.settings).milestoneMessages??[],set:r=>{n.settings.milestoneMessages=r}}),F=P(()=>{const r=Math.max(1,n.settings.starsToInvincible||1),t=h.value;for(const c of t){if(!c.message?.trim())return"é‡Œç¨‹ç¢‘è¨Šæ¯å…§å®¹ä¸èƒ½ç‚ºç©º";if(c.message.length>se)return`é‡Œç¨‹ç¢‘è¨Šæ¯æœ€å¤š ${se} å€‹å­—`;if(c.threshold<1||c.threshold>r)return`é‡Œç¨‹ç¢‘é–€æª»å¿…é ˆä»‹æ–¼ 1 åˆ° ${r}`}return null}),ne=()=>{const r=Math.max(1,n.settings.starsToInvincible||1),t=h.value,c=new Set(t.map(M=>M.threshold));let C=1;for(;C<=r&&c.has(C);)C++;C>r||(h.value=[...t,{threshold:C,message:"æ–°çš„é‡Œç¨‹ç¢‘è¨Šæ¯"}].sort((M,J)=>M.threshold-J.threshold))},ae=r=>{const t=[...h.value];t.splice(r,1),h.value=t},oe=(r,t)=>{const c=Math.max(1,n.settings.starsToInvincible||1),C=Math.min(c,Math.max(1,Math.floor(Number(t)||0))),M=[...h.value];M[r]={...M[r],threshold:C},h.value=M.sort((J,A)=>J.threshold-A.threshold)},K=(r,t)=>{const c=(t||"").slice(0,se),C=[...h.value];C[r]={...C[r],message:c},h.value=C};O(()=>b.initialTemplate,r=>{if(r){const t=JSON.parse(JSON.stringify(r));n.id=t.id,n.name=t.name,n.settings=S(t.settings),n.isDefault=!1}else n.id="",n.name="æ–°çš„çå‹µç¯„æœ¬",n.settings=S(p()),n.isDefault=!1},{deep:!0}),O(()=>b.defaultSettings,()=>{f.value&&!b.initialTemplate&&(n.settings=S(p()))},{deep:!0}),O(()=>b.isCreatingNew,r=>{f.value=r}),O(()=>n.settings.invincibleDurationSeconds,r=>{typeof r=="number"&&(_.value=Math.floor(r/60),a.value=r%60)},{immediate:!0}),O([_,a],([r,t])=>{if(typeof r=="number"&&typeof t=="number"){const c=Math.min(Math.max(t,0),59);c!==t&&(a.value=c);const C=r*60+c;C>0&&(n.settings.invincibleDurationSeconds=C)}}),O(()=>n.settings.starsToInvincible,()=>{h.value=S(n.settings).milestoneMessages??[]}),O(()=>n.settings.mode,r=>{r==="class-total"&&(n.settings.classTotalTargetPoints||(n.settings.classTotalTargetPoints=200))});const ie=r=>{f.value&&!b.initialTemplate&&(n.id="",n.name="æ–°çš„çå‹µç¯„æœ¬",r?n.settings=S(JSON.parse(JSON.stringify(r))):n.settings=S(p()),n.isDefault=!1),T.value&&T.value.showModal()},ee=()=>{T.value&&T.value.close()},U=()=>{if(F.value){alert(F.value);return}S(n.settings),I("save",n,f.value),ee()},G=()=>{I("cancel"),ee()};return y({open:ie,close:ee}),(r,t)=>(d(),u("dialog",{ref_key:"dialogRef",ref:T,class:"modal modal-bottom sm:modal-middle"},[e("div",Ns,[e("h2",js,i(f.value?"å»ºç«‹æ–°ç¯„æœ¬":"ç·¨è¼¯ç¯„æœ¬"),1),D.value?(d(),u("div",Us,[v(z,{name:"AlertTriangle",class:"w-5 h-5 flex-shrink-0"}),e("div",Es,[e("div",Os," âš ï¸ æ­¤ç¯„æœ¬æ­£è¢« "+i($.value.length)+" å€‹ç­ç´šä½¿ç”¨ä¸­ ",1),e("div",Vs,[t[8]||(t[8]=e("div",null,"å—å½±éŸ¿ç­ç´šï¼š",-1)),e("ul",Ls,[(d(!0),u(j,null,te($.value,c=>(d(),u("li",{key:c.id},i(c.name),1))),128))]),t[9]||(t[9]=e("div",{class:"mt-1.5"}," æ–°çš„è¨­å®šæœƒç«‹å³æ‡‰ç”¨åˆ°æœªä¾†çš„å¾—åˆ†ï¼Œä½†å·²æ”¶é›†çš„æ˜Ÿæ˜Ÿä¸æœƒè¢«é‡æ–°è¨ˆç®—ã€‚ ",-1))])])])):R("",!0),e("div",zs,[e("div",Fs,[t[10]||(t[10]=e("label",{class:"label pb-2"},[e("span",{class:"label-text font-semibold text-base text-black"},"ç¯„æœ¬åç¨±"),e("span",{class:"label-text-alt text-xs text-base-content text-black"},"ç”¨æ–¼è­˜åˆ¥é€™å€‹ç¯„æœ¬")],-1)),E(e("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>n.name=c),type:"text",placeholder:"ä¾‹ï¼šåŸºç¤çå‹µã€æ¿€å‹µæ¨¡å¼",class:"input input-bordered focus:input-primary"},null,512),[[Q,n.name]])]),t[26]||(t[26]=e("div",{class:"divider my-2"},null,-1)),e("div",Gs,[e("div",Js,[v(z,{name:"Settings2",class:"w-4 h-4 inline mr-2"}),t[11]||(t[11]=x(" çå‹µåƒæ•¸è¨­å®š ",-1))]),e("div",Xs,[e("label",Ws,[t[12]||(t[12]=e("span",{class:"label-text text-sm text-black"},"çå‹µæ¨¡å¼",-1)),e("span",Hs,i(f.value?"é¸æ“‡æ¨¡å¼é¡å‹":"ç„¡æ³•ä¿®æ”¹"),1)]),E(e("select",{"onUpdate:modelValue":t[1]||(t[1]=c=>n.settings.mode=c),class:"select select-sm select-bordered focus:select-primary",disabled:!f.value},[...t[13]||(t[13]=[e("option",{value:"class-total"},"å…¨ç­å”ä½œæ¨¡å¼",-1),e("option",{value:"group-based"},"å„çµ„ç¨ç«‹æ¨¡å¼",-1)])],8,Ys),[[he,n.settings.mode]])]),n.settings.mode==="class-total"?(d(),u("div",qs,[t[14]||(t[14]=e("label",{class:"label pb-1.5"},[e("span",{class:"label-text text-sm text-black"},"å…¨ç­ç›®æ¨™åˆ†æ•¸"),e("span",{class:"label-text-alt text-xs text-black"},"é”åˆ°æ­¤åˆ†æ•¸è®Šç„¡æ•µ")],-1)),E(e("input",{"onUpdate:modelValue":t[2]||(t[2]=c=>n.settings.classTotalTargetPoints=c),type:"number",min:"1",class:"input input-sm input-bordered focus:input-primary"},null,512),[[Q,n.settings.classTotalTargetPoints,void 0,{number:!0}]])])):n.settings.mode==="group-based"?(d(),u(j,{key:1},[e("div",Ks,[t[15]||(t[15]=e("label",{class:"label pb-1.5"},[e("span",{class:"label-text text-sm text-black"},"å¾—åˆ†é–€æª»"),e("span",{class:"label-text-alt text-xs text-black"},"å¤šå°‘åˆ†ä¸€é¡†æ˜Ÿ")],-1)),E(e("input",{"onUpdate:modelValue":t[3]||(t[3]=c=>n.settings.pointsPerStar=c),type:"number",min:"1",class:"input input-sm input-bordered focus:input-primary"},null,512),[[Q,n.settings.pointsPerStar,void 0,{number:!0}]])]),e("div",Qs,[t[16]||(t[16]=e("label",{class:"label pb-1.5"},[e("span",{class:"label-text text-sm text-black"},"æ˜Ÿæ˜Ÿé–€æª»"),e("span",{class:"label-text-alt text-xs text-black"},"å¹¾é¡†æ˜Ÿè®Šç„¡æ•µ")],-1)),E(e("input",{"onUpdate:modelValue":t[4]||(t[4]=c=>n.settings.starsToInvincible=c),type:"number",min:"1",class:"input input-sm input-bordered focus:input-primary"},null,512),[[Q,n.settings.starsToInvincible,void 0,{number:!0}]])])],64)):R("",!0),e("div",Zs,[t[18]||(t[18]=e("label",{class:"label pb-1.5"},[e("span",{class:"label-text text-sm text-black"},"ç„¡æ•µæŒçºŒæ™‚é–“"),e("span",{class:"label-text-alt text-xs text-black"},"åˆ†é˜ : ç§’")],-1)),e("div",et,[e("div",st,[E(e("input",{"onUpdate:modelValue":t[5]||(t[5]=c=>_.value=c),type:"number",placeholder:"åˆ†",min:"0",max:"60",class:"input input-sm input-bordered focus:input-primary w-full"},null,512),[[Q,_.value,void 0,{number:!0}]])]),t[17]||(t[17]=e("span",{class:"text-base-content/60"},":",-1)),e("div",tt,[E(e("input",{"onUpdate:modelValue":t[6]||(t[6]=c=>a.value=c),type:"number",placeholder:"ç§’",min:"0",max:"59",class:"input input-sm input-bordered focus:input-primary w-full"},null,512),[[Q,a.value,void 0,{number:!0}]])])])]),e("div",lt,[t[19]||(t[19]=e("label",{class:"label pb-1.5"},[e("span",{class:"label-text text-sm text-black"},"ç„¡æ•µåŠ åˆ†å€¼"),e("span",{class:"label-text-alt text-xs text-black"},"ç„¡æ•µæ™‚æ¯æ¬¡åŠ å¹¾åˆ†")],-1)),E(e("input",{"onUpdate:modelValue":t[7]||(t[7]=c=>n.settings.invinciblePointsPerClick=c),type:"number",min:"1",class:"input input-sm input-bordered focus:input-primary"},null,512),[[Q,n.settings.invinciblePointsPerClick,void 0,{number:!0,lazy:!0}]])]),n.settings.mode==="group-based"?(d(),u("div",nt,[e("div",at,[t[21]||(t[21]=e("div",null,[e("div",{class:"font-semibold text-sm"},"æ˜Ÿæ˜Ÿé‡Œç¨‹ç¢‘æç¤º"),e("p",{class:"text-xs text-base-content/60 mt-1"},[x(" è‡ªè¨‚ä¸åŒæ˜Ÿæ˜Ÿé–€æª»é”æˆæ™‚è¦é¡¯ç¤ºçš„æé†’å…§å®¹ã€‚ "),e("span",{class:"text-warning"},"é‡Œç¨‹ç¢‘ä¸å¯è¨­åœ¨ç„¡æ•µæ˜Ÿæ˜Ÿé–€æª»ï¼Œå› ç‚ºæœƒè¢«æ­å–œå‹•ç•«é®æ“‹ã€‚")])],-1)),e("button",{type:"button",class:"btn btn-xs btn-outline gap-1",onClick:ne,disabled:h.value.length>=Math.max(1,n.settings.starsToInvincible-1)},[v(z,{name:"Plus",class:"w-3.5 h-3.5"}),t[20]||(t[20]=x(" æ–°å¢é‡Œç¨‹ç¢‘ ",-1))],8,ot)]),F.value?(d(),u("div",it,[v(z,{name:"AlertCircle",class:"w-4 h-4"}),e("span",rt,i(F.value),1)])):R("",!0),e("div",dt,[(d(!0),u(j,null,te(h.value,(c,C)=>(d(),u("div",{key:`template-milestone-${C}`,class:"rounded-lg border border-base-200 bg-base-100/80 p-3"},[e("div",ct,[e("div",ut,[t[23]||(t[23]=e("span",{class:"text-xs font-semibold text-base-content/70"}," é”åˆ°æ˜Ÿæ˜Ÿæ•¸ ",-1)),e("div",pt,[e("input",{value:c.threshold,type:"number",class:"input input-sm input-bordered w-20 text-center",min:"1",max:Math.max(1,n.settings.starsToInvincible-1),onInput:M=>oe(C,M.target.valueAsNumber)},null,40,bt),t[22]||(t[22]=e("span",{class:"text-sm text-base-content/60"},"é¡†",-1))])]),e("div",mt,[t[24]||(t[24]=e("span",{class:"text-xs font-semibold text-base-content/70"}," æç¤ºè¨Šæ¯ ",-1)),e("div",vt,[e("input",{value:c.message,type:"text",class:"input input-sm input-bordered w-full",maxlength:H(se),onInput:M=>K(C,M.target.value||"")},null,40,gt),e("span",ft,i(c.message.length)+"/"+i(H(se)),1)])]),e("div",xt,[e("button",{type:"button",class:"btn btn-xs btn-outline btn-error gap-1",onClick:M=>ae(C)},[v(z,{name:"Trash2",class:"w-3.5 h-3.5"}),t[25]||(t[25]=x(" ç§»é™¤ ",-1))],8,ht)])])]))),128))])])):R("",!0)])]),e("div",_t,[e("button",{onClick:G,class:"btn btn-outline"},[v(z,{name:"X",class:"w-4 h-4"}),t[27]||(t[27]=x(" å–æ¶ˆ ",-1))]),e("button",{onClick:U,class:"btn btn-success"},[v(z,{name:"Check",class:"w-4 h-4"}),t[28]||(t[28]=x(" å„²å­˜ ",-1))])])]),t[29]||(t[29]=e("form",{method:"dialog",class:"modal-backdrop"},[e("button")],-1))],512))}}),wt=Object.assign(yt,{__name:"RewardTemplateModal"}),Tt={class:"modal-box"},kt={class:"font-bold text-lg"},$t={class:"py-4 whitespace-pre-wrap"},Ct={class:"modal-action"},St=le({__name:"ConfirmDialog",props:{title:{},message:{},confirmText:{default:"ç¢ºèª"},cancelText:{default:"å–æ¶ˆ"}},emits:["confirm","cancel"],setup(q,{expose:y,emit:w}){const b=w,I=k(!1),T=()=>{I.value=!0},f=()=>{I.value=!1},p=()=>{b("confirm"),f()},n=()=>{b("cancel"),f()};return y({open:T,close:f}),(g,$)=>(d(),u("div",{class:B(["modal",{"modal-open":I.value}])},[e("div",Tt,[e("h3",kt,i(g.title),1),e("p",$t,i(g.message),1),e("div",Ct,[e("button",{onClick:n,class:"btn btn-ghost"},i(g.cancelText),1),e("button",{onClick:p,class:"btn btn-primary"},i(g.confirmText),1)])]),e("label",{class:"modal-backdrop",onClick:n})],2))}}),Mt=Object.assign(St,{__name:"ConfirmDialog"}),It={class:"flex h-[calc(100vh-4rem)] bg-base-100"},Dt={class:"p-4 border-b bg-base-200/50"},Pt={class:"flex items-center justify-between mb-3"},Bt={class:"font-bold text-lg flex items-center gap-2"},Rt={role:"tablist","aria-label":"ç¯„æœ¬åº«æ¨¡å¼åˆ‡æ›",class:"grid grid-cols-2 items-center gap-2 bg-base-200/70 p-1 rounded-2xl"},At=["aria-selected"],Nt={class:"ml-1 inline-flex items-center justify-center min-w-[1.35rem] h-5 rounded-full bg-base-300 text-[11px] font-semibold text-base-content/80"},jt=["aria-selected"],Ut={class:"ml-1 inline-flex items-center justify-center min-w-[1.35rem] h-5 rounded-full bg-base-300 text-[11px] font-semibold text-base-content/80"},Et=["onDragstart","onDragover","onDragenter","onDrop"],Ot={class:"flex items-start justify-between gap-2 mb-2"},Vt={class:"flex-1"},Lt={class:"font-semibold text-sm"},zt={class:"flex gap-1 flex-shrink-0 items-center"},Ft={class:"tooltip tooltip-left","data-tip":"ç·¨è¼¯é€™å€‹ç¯„æœ¬"},Gt=["onClick"],Jt={class:"tooltip tooltip-left","data-tip":"åˆªé™¤é€™å€‹ç¯„æœ¬"},Xt=["onClick"],Wt={class:"tooltip tooltip-left","data-tip":"æ‹–æ›³æ’åºç¯„æœ¬"},Ht={class:"w-4 h-4 flex items-center justify-center opacity-40"},Yt={class:"text-xs space-y-1 text-base-content !text-black"},qt={class:"font-semibold"},Kt={class:"font-semibold"},Qt={class:"font-semibold"},Zt={class:"font-semibold"},el={class:"font-semibold"},sl={class:"font-semibold"},tl={class:"font-semibold"},ll={class:"p-4 border-t"},nl={class:"flex-1 flex flex-col overflow-hidden"},al={class:"p-4 sm:p-6 border-b bg-base-100 shrink-0"},ol={class:"p-4 border-b bg-base-100 shrink-0"},il={class:"flex items-center justify-between"},rl={class:"flex items-center gap-4"},dl={class:"flex items-center gap-4"},cl={key:0,class:"flex items-center gap-2"},ul={class:"text-sm text-base-content badge badge-lg"},pl={class:"flex-1 overflow-auto p-4"},bl={class:"card bg-base-100 shadow"},ml={class:"card-body p-0"},vl={class:"table table-zebra w-full"},gl={class:"sticky top-0 bg-base-200 z-10"},fl={class:"w-12"},xl=["checked"],hl=["checked","onChange"],_l={class:"font-semibold"},yl={class:"text-xs text-base-content flex items-center gap-1"},wl={class:"text-center"},Tl={key:0,class:"badge badge-success badge-sm gap-1"},kl={key:1,class:"badge badge-ghost badge-sm"},$l={class:"text-right"},Cl=["onClick"],Sl={key:0},Ml={colspan:"5",class:"text-center text-base-content py-12"},Il={class:"flex flex-col items-center gap-2"},Dl={key:0,class:"fixed inset-0 z-50 flex items-center justify-end"},Pl={class:"relative w-[600px] h-full bg-base-100 shadow-2xl flex flex-col animate-slide-in-right"},Bl={class:"p-6 border-b flex items-center justify-between shrink-0"},Rl={class:"text-2xl font-bold"},Al={class:"flex-1 overflow-y-auto p-6"},Nl={class:"modal-box max-w-2xl max-h-[calc(100vh-4rem)] overflow-y-auto my-8"},jl={class:"flex flex-col gap-6"},Ul={class:"flex items-start justify-between"},El={class:"font-bold text-xl flex items-center gap-2"},Ol={class:"text-xs text-base-content/70"},Vl={class:"grid gap-3 sm:grid-cols-2"},Ll={class:"flex items-center justify-between"},zl={class:"flex items-center gap-2 text-base-content"},Fl={class:"flex items-center gap-2 text-base-content"},Gl={key:0,class:"space-y-4"},Jl={class:"flex flex-wrap items-center gap-2 bg-base-200/70 p-1.5 rounded-2xl",role:"tablist","aria-label":"ç¯„æœ¬æ¨¡å¼åˆ‡æ›"},Xl=["aria-selected"],Wl={class:"text-xs text-base-content/50"},Hl=["aria-selected"],Yl={class:"text-xs text-base-content/50"},ql={class:"text-xs text-base-content/70 mt-2"},Kl={class:"text-xs text-base-content/70 mt-1"},Ql={key:0,class:"rounded-2xl border border-dashed border-base-300 bg-base-200/60 p-6 text-center text-sm text-base-content/70"},Zl={key:1,class:"space-y-3 max-h-64 overflow-y-auto pr-1"},en=["value"],sn={class:"flex-1"},tn={class:"flex flex-wrap items-center gap-2"},ln={class:"font-semibold text-base-content"},nn={class:"mt-3 text-xs text-base-content/70 grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-2"},an={class:"flex items-center gap-2"},on={class:"flex items-center gap-2"},rn={class:"flex items-center gap-2"},dn={class:"flex items-center gap-2"},cn={class:"flex items-center gap-2"},un={class:"flex items-center gap-2"},pn={class:"flex items-center gap-2"},bn={class:"alert alert-info"},mn={class:"text-sm leading-relaxed"},vn={key:0},gn={key:1},fn={class:"modal-action"},xn=["disabled"],hn=le({__name:"rewards",setup(q){const y=ve(),w=ye(),b=ze(),I=k(!0),T=k(!1),f=k(null),p=k([]),n=k(!1),g=k(""),$=k("template"),D=k("class-total"),_=k("class-total"),a=P(()=>y.rewardTemplates.filter(l=>l.settings.mode===_.value)),S=P(()=>y.rewardTemplates.filter(l=>l.settings.mode==="class-total").length),h=P(()=>y.rewardTemplates.filter(l=>l.settings.mode==="group-based").length);S.value===0&&h.value>0&&(D.value="group-based");const F=P(()=>y.rewardTemplates.filter(l=>l.settings.mode===D.value)),ne=()=>S.value===0&&h.value>0?"group-based":"class-total",ae=l=>typeof l!="number"||Number.isNaN(l)?"â€”":Z(l);O(D,()=>{y.getTemplateById(g.value)?.settings.mode!==D.value&&(g.value="")}),O($,l=>{l!=="template"&&(g.value="")}),O([S,h],()=>{S.value+h.value>0&&F.value.length===0&&(D.value=ne())});const oe=k(null),K=k(null),ie=k(""),ee=k("");k([]);const U=k(null),G=k(null),r=k(null),t=k(null),c=k(!1),C=P(()=>_.value==="class-total"?{enabled:!0,mode:"class-total",classTotalTargetPoints:100,invincibleDurationSeconds:30,invinciblePointsPerClick:5,milestoneMessages:me(3)}:{enabled:!0,mode:"group-based",pointsPerStar:10,starsToInvincible:3,invincibleDurationSeconds:30,invinciblePointsPerClick:5,milestoneMessages:me(3)}),M=P(()=>w.classes.length>0&&p.value.length===w.classes.length),J=()=>{M.value?p.value=[]:p.value=w.classes.map(l=>l.id)},A=l=>{const s=p.value.indexOf(l);s>-1?p.value.splice(s,1):p.value.push(l)},Y=l=>w.classes.find(m=>m.id===l)?.groupingActive||!1,re=l=>l.filter(s=>Y(s)),pe=(l,s,m)=>{ie.value=l,ee.value=s,K.value=m,oe.value?.open()},we=()=>{K.value&&(K.value(),K.value=null)},Te=()=>{K.value=null},ke=(l,s)=>{U.value=s,l.dataTransfer&&(l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("text/plain",String(s)))},$e=()=>{U.value=null,G.value=null},ge=(l,s)=>{U.value!==null&&(l.preventDefault(),G.value=s)},Ce=l=>{const s=l.currentTarget.getBoundingClientRect();(l.clientX<s.left||l.clientX>s.right||l.clientY<s.top||l.clientY>s.bottom)&&(G.value=null)},Se=(l,s)=>{if(l.preventDefault(),l.stopPropagation(),U.value===null||U.value===s){U.value=null,G.value=null;return}const N=a.value[U.value];if(!N){U.value=null,G.value=null;return}y.moveTemplateWithinMode(N.settings.mode,N.id,s)&&b.showSuccess("ç¯„æœ¬æ’åºå·²æ›´æ–°"),U.value=null,G.value=null},Me=l=>{f.value=l,T.value=!0},de=()=>{T.value=!1,setTimeout(()=>{f.value=null},300)},Ie=l=>{const m=w.classes.find(X=>X.id===l.classId)?.name||"æ­¤ç­ç´š",N=Y(l.classId),V=()=>{let X=!1;l.mode==="disabled"?X=w.setRewardSettingsMode(l.classId,"disabled"):l.mode==="template"&&l.templateId&&(X=w.applyTemplateToClass(l.classId,l.templateId)),X?(b.showSuccess("ç­ç´šçå‹µè¨­å®šå·²æ›´æ–°"),de()):b.showError("æ›´æ–°è¨­å®šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")};N&&l.mode==="template"?pe("æ´»å‹•é€²è¡Œä¸­",`ç­ç´šã€Œ${m}ã€ç›®å‰æœ‰æ´»å‹•é€²è¡Œä¸­ã€‚

æ”¹è®Šçå‹µç¯„æœ¬å¯èƒ½å°è‡´åˆ†æ•¸è¨ˆç®—å¤±æº–ã€‚

ç¢ºå®šè¦æ”¹è®Šè¨­å®šå—ï¼Ÿ`,V):V()},fe=()=>{$.value="template",g.value="",D.value=ne()},De=()=>{fe(),n.value=!0},ce=()=>{n.value=!1,fe()},Pe=()=>{$.value==="template"?Be():$.value==="disable"&&Re()},Be=()=>{if(!g.value)return;const l=re(p.value),s=y.getTemplateById(g.value),m=()=>{w.applyTemplateToMultipleClasses(g.value,p.value)?(b.showSuccess(`å·²å¥—ç”¨ã€Œ${s?.name}ã€è‡³ ${p.value.length} å€‹ç­ç´š`),p.value=[],ce()):b.showError("å¥—ç”¨ç¯„æœ¬å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")};if(l.length>0){const N=l.map(V=>w.classes.find(X=>X.id===V)?.name).filter(Boolean).join("ã€");pe("æœ‰ç­ç´šæ­£åœ¨æ´»å‹•ä¸­",`ä»¥ä¸‹ç­ç´šæ­£åœ¨æ´»å‹•é€²è¡Œä¸­ï¼š${N}

æ”¹è®Šçå‹µç¯„æœ¬å¯èƒ½å°è‡´åˆ†æ•¸è¨ˆç®—å¤±æº–ã€‚

ç¢ºå®šè¦å¥—ç”¨ã€Œ${s?.name}ã€è‡³æ‰€æœ‰é¸å®šç­ç´šå—ï¼Ÿ`,m)}else m()},Re=()=>{const l=re(p.value),s=()=>{let m=0;p.value.forEach(N=>{w.setRewardSettingsMode(N,"disabled")&&m++}),m>0?(b.showSuccess(`å·²åœç”¨ ${m} å€‹ç­ç´šçš„çå‹µæ©Ÿåˆ¶`),p.value=[],ce()):b.showError("åœç”¨çå‹µå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")};if(l.length>0){const m=l.map(N=>w.classes.find(V=>V.id===N)?.name).filter(Boolean).join("ã€");pe("æœ‰ç­ç´šæ­£åœ¨æ´»å‹•ä¸­",`ä»¥ä¸‹ç­ç´šæ­£åœ¨æ´»å‹•é€²è¡Œä¸­ï¼š${m}

åœç”¨çå‹µæ©Ÿåˆ¶å¾Œï¼Œæ´»å‹•ä¸­çš„çå‹µå°‡ç„¡æ³•ç¹¼çºŒè¨ˆç®—ã€‚

ç¢ºå®šè¦åœç”¨æ‰€æœ‰é¸å®šç­ç´šçš„çå‹µå—ï¼Ÿ`,s)}else s()},Ae=()=>{t.value=null,c.value=!0,r.value?.open(C.value)},Ne=l=>{t.value=l,c.value=!1,r.value?.open()},je=l=>{confirm("ç¢ºå®šè¦åˆªé™¤æ­¤ç¯„æœ¬å—ï¼Ÿ")&&(y.deleteTemplate(l)?b.showSuccess("ç¯„æœ¬å·²åˆªé™¤"):b.showError("ç„¡æ³•åˆªé™¤é è¨­ç¯„æœ¬"))},Ue=(l,s)=>{s?y.addTemplate(l.name,l.settings)&&(b.showSuccess("ç¯„æœ¬å·²å»ºç«‹"),t.value=null,c.value=!1):(y.updateTemplate(l.id,l),b.showSuccess("ç¯„æœ¬å·²æ›´æ–°"),t.value=null,c.value=!1)},Ee=()=>{t.value=null,c.value=!1},Oe=()=>{confirm(`ç¢ºå®šè¦é‡è¨­ç³»çµ±å—ï¼Ÿ

é€™å°‡ï¼š
â€¢ æ¸…é™¤æ‰€æœ‰è‡ªè¨‚çå‹µç¯„æœ¬
â€¢ æ¢å¾©å…©å€‹åˆå§‹ç¯„æœ¬ï¼ˆå„çµ„ç¨ç«‹ + å…¨ç­å”ä½œï¼‰
â€¢ æ‰€æœ‰ç­ç´šçš„çå‹µè¨­å®šå°‡è¢«åœç”¨

æ­¤å‹•ä½œç„¡æ³•å¾©åŸï¼`)&&(y.resetToDefault(),w.resetAllClassesToDefault(),p.value=[],b.showSuccess("ç³»çµ±å·²é‡è¨­åˆ°åˆå§‹ç‹€æ…‹"))};return(l,s)=>{const m=z,N=Ye,V=As,X=wt;return d(),u("div",It,[e("aside",{class:B(["w-80 border-r border-base-300 transition-all duration-300 flex flex-col",{"-ml-80":!I.value}])},[e("div",Dt,[e("div",Pt,[e("h3",Bt,[v(m,{name:"LayoutGrid",class:"w-5 h-5"}),s[12]||(s[12]=x(" ç¯„æœ¬åº« ",-1))]),e("button",{onClick:s[0]||(s[0]=o=>I.value=!1),class:"btn btn-ghost btn-sm btn-circle"},[v(m,{name:"ChevronsLeft",class:"w-4 h-4"})])]),e("div",Rt,[e("button",{type:"button",role:"tab","aria-selected":_.value==="class-total",class:B(["flex items-center justify-center gap-1.5 px-3 py-2 rounded-xl text-xs font-semibold transition-all border border-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-primary",{"bg-base-100 text-primary shadow-[0_6px_18px_rgba(25,39,85,0.15)] border-primary/20":_.value==="class-total","text-base-content/60 hover:text-base-content hover:bg-base-100/70":_.value!=="class-total"}]),onClick:s[1]||(s[1]=o=>_.value="class-total")},[v(m,{name:"Users",class:"w-3.5 h-3.5"}),s[13]||(s[13]=e("span",null,"å…¨ç­å”ä½œ",-1)),e("span",Nt,i(S.value),1)],10,At),e("button",{type:"button",role:"tab","aria-selected":_.value==="group-based",class:B(["flex items-center justify-center gap-1.5 px-3 py-2 rounded-xl text-xs font-semibold transition-all border border-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-primary",{"bg-base-100 text-primary shadow-[0_6px_18px_rgba(25,39,85,0.15)] border-primary/20":_.value==="group-based","text-base-content/60 hover:text-base-content hover:bg-base-100/70":_.value!=="group-based"}]),onClick:s[2]||(s[2]=o=>_.value="group-based")},[v(m,{name:"Trophy",class:"w-3.5 h-3.5"}),s[14]||(s[14]=e("span",null,"å„çµ„ç¨ç«‹",-1)),e("span",Ut,i(h.value),1)],10,jt)])]),e("div",{class:"p-4 space-y-2 overflow-y-auto flex-1",onDragover:s[3]||(s[3]=ue(()=>{},["prevent"])),onDragenter:s[4]||(s[4]=ue(()=>{},["prevent"]))},[(d(!0),u(j,null,te(a.value,(o,L)=>(d(),u("div",{key:o.id,draggable:"true",onDragstart:W=>ke(W,L),onDragend:$e,onDragover:ue(W=>ge(W,L),["prevent"]),onDragenter:ue(W=>ge(W,L),["prevent"]),onDragleave:Ce,onDrop:W=>Se(W,L),class:B(["p-3 rounded-lg bg-base-200 cursor-grab active:cursor-grabbing hover:shadow-md transition-all hover:scale-[1.02] flex flex-col relative",{"opacity-50":U.value===L,"ring-2 ring-primary ring-offset-2":G.value===L}])},[e("div",Ot,[e("div",Vt,[e("span",Lt,i(o.name),1)]),e("div",zt,[e("div",Ft,[e("button",{onClick:W=>Ne(o),class:"btn btn-xs btn-ghost"},[v(m,{name:"Edit2",class:"w-3 h-3"})],8,Gt)]),e("div",Jt,[e("button",{onClick:W=>je(o.id),class:"btn btn-xs btn-ghost text-error"},[v(m,{name:"Trash2",class:"w-3 h-3"})],8,Xt)]),e("div",Wt,[e("div",Ht,[v(m,{name:"GripVertical",class:"w-4 h-4"})])])])]),e("div",Yt,[o.settings.mode==="class-total"?(d(),u(j,{key:0},[e("div",null,[s[15]||(s[15]=x(" ğŸ¯ å…¨ç­ç›®æ¨™ï¼š",-1)),e("span",qt,i(o.settings.classTotalTargetPoints),1),s[16]||(s[16]=x(" åˆ† ",-1))]),e("div",null,[s[17]||(s[17]=x(" â±ï¸ ç„¡æ•µæ™‚é•·ï¼š",-1)),e("span",Kt,i(H(Z)(o.settings.invincibleDurationSeconds)),1)]),e("div",null,[s[18]||(s[18]=x(" ğŸ’ ç„¡æ•µåŠ åˆ†ï¼š",-1)),e("span",Qt,i(o.settings.invinciblePointsPerClick),1),s[19]||(s[19]=x(" åˆ†/æ¬¡ ",-1))])],64)):o.settings.mode==="group-based"?(d(),u(j,{key:1},[e("div",null,[s[20]||(s[20]=x(" ğŸ’° æ¯æ˜Ÿéœ€æ±‚ï¼š",-1)),e("span",Zt,i(o.settings.pointsPerStar),1),s[21]||(s[21]=x(" åˆ† ",-1))]),e("div",null,[s[22]||(s[22]=x(" â­ é”æˆç„¡æ•µï¼š",-1)),e("span",el,i(o.settings.starsToInvincible),1),s[23]||(s[23]=x(" æ˜Ÿ ",-1))]),e("div",null,[s[24]||(s[24]=x(" â±ï¸ ç„¡æ•µæ™‚é•·ï¼š",-1)),e("span",sl,i(H(Z)(o.settings.invincibleDurationSeconds)),1)]),e("div",null,[s[25]||(s[25]=x(" ğŸ¯ ç„¡æ•µåŠ åˆ†ï¼š",-1)),e("span",tl,i(o.settings.invinciblePointsPerClick),1),s[26]||(s[26]=x(" åˆ†/æ¬¡ ",-1))])],64)):R("",!0)])],42,Et))),128))],32),e("div",ll,[e("button",{onClick:Ae,class:"btn btn-primary btn-sm btn-block gap-2"},[v(m,{name:"Plus",class:"w-4 h-4"}),x(" æ–°å¢"+i(_.value==="class-total"?"å…¨ç­å”ä½œ":"å„çµ„ç¨ç«‹")+"ç¯„æœ¬ ",1)])])],2),e("main",nl,[e("div",al,[v(Ge,{title:"çå‹µæ©Ÿåˆ¶ç®¡ç†",description:"ç®¡ç†ç­ç´šçš„çå‹µè¨­å®šåŠç¯„æœ¬å¥—ç”¨ã€‚"})]),e("div",ol,[e("div",il,[e("div",rl,[I.value?R("",!0):(d(),u("button",{key:0,onClick:s[5]||(s[5]=o=>I.value=!0),class:"btn btn-ghost btn-sm gap-2"},[v(m,{name:"LayoutGrid",class:"w-4 h-4"}),s[27]||(s[27]=x(" ç¯„æœ¬åº« ",-1))]))]),e("div",dl,[p.value.length>0?(d(),u("div",cl,[e("span",ul," å·²é¸ "+i(p.value.length)+" å€‹ç­ç´š ",1),e("button",{onClick:De,class:"btn btn-primary btn-sm gap-2"},[v(m,{name:"Sparkles",class:"w-4 h-4"}),s[28]||(s[28]=x(" æ‰¹æ¬¡å¥—ç”¨ ",-1))]),e("button",{onClick:s[6]||(s[6]=o=>p.value=[]),class:"btn btn-ghost btn-sm"}," å–æ¶ˆ ")])):R("",!0),e("button",{onClick:Oe,class:"btn btn-outline btn-error btn-sm gap-2",title:"é‡è¨­æ‰€æœ‰çå‹µç¯„æœ¬åˆ°åˆå§‹ç‹€æ…‹"},[v(m,{name:"RefreshCw",class:"w-4 h-4"}),s[29]||(s[29]=x(" é‡è¨­å›é è¨­çå‹µ ",-1))])])])]),e("div",pl,[e("div",bl,[e("div",ml,[e("table",vl,[e("thead",gl,[e("tr",null,[e("th",fl,[e("input",{type:"checkbox",class:"checkbox checkbox-sm",checked:M.value,onChange:J},null,40,xl)]),s[30]||(s[30]=e("th",null,"ç­ç´š",-1)),s[31]||(s[31]=e("th",null,"ç›®å‰çå‹µè¨­å®š",-1)),s[32]||(s[32]=e("th",{class:"text-center"},"ç‹€æ…‹",-1)),s[33]||(s[33]=e("th",{class:"w-32 text-right"},"æ“ä½œ",-1))])]),e("tbody",null,[(d(!0),u(j,null,te(H(w).classes,o=>(d(),u("tr",{key:o.id,class:"hover:bg-base-200/50 transition-colors"},[e("td",null,[e("input",{type:"checkbox",class:"checkbox checkbox-sm",checked:p.value.includes(o.id),onChange:L=>A(o.id)},null,40,hl)]),e("td",null,[e("div",_l,i(o.name),1),e("div",yl,[v(m,{name:"Users",class:"w-3 h-3"}),x(" "+i(o.students.length)+" äºº ",1)])]),e("td",null,[v(N,{"class-info":o},null,8,["class-info"])]),e("td",wl,[o.groupingActive?(d(),u("span",Tl,[v(m,{name:"Play",class:"w-3 h-3"}),s[34]||(s[34]=x(" æ´»å‹•ä¸­ ",-1))])):(d(),u("span",kl," å¾…æ©Ÿä¸­ "))]),e("td",$l,[e("button",{onClick:L=>Me(o),class:"btn btn-ghost btn-sm gap-1"},[v(m,{name:"Settings",class:"w-4 h-4"}),s[35]||(s[35]=x(" è¨­å®š ",-1))],8,Cl)])]))),128)),H(w).classes.length===0?(d(),u("tr",Sl,[e("td",Ml,[e("div",Il,[v(m,{name:"AlertCircle",class:"w-8 h-8 opacity-40"}),s[36]||(s[36]=e("p",{class:"text-sm"},"å°šç„¡ç­ç´šï¼Œè«‹å…ˆåœ¨é¦–é æ–°å¢ç­ç´š",-1))])])])):R("",!0)])])])])])]),(d(),xe(Fe,{to:"body"},[T.value?(d(),u("div",Dl,[e("div",{class:"absolute inset-0 bg-black/50",onClick:de}),e("div",Pl,[e("div",Bl,[e("div",null,[e("h2",Rl,i(f.value?.name),1),s[37]||(s[37]=e("p",{class:"text-sm text-base-content mt-1"},"çå‹µæ©Ÿåˆ¶è¨­å®š",-1))]),e("button",{onClick:de,class:"btn btn-ghost btn-sm btn-circle"},[v(m,{name:"X",class:"w-5 h-5"})])]),e("div",Al,[f.value?(d(),xe(V,{key:0,"class-info":f.value,templates:H(y).rewardTemplates,onSave:Ie,onCancel:de},null,8,["class-info","templates"])):R("",!0)])])])):R("",!0)])),e("div",{class:B(["modal",{"modal-open":n.value}])},[e("div",Nl,[e("div",jl,[e("div",Ul,[e("h3",El,[v(m,{name:"Sparkles",class:"w-5 h-5"}),s[38]||(s[38]=x(" æ‰¹æ¬¡å¥—ç”¨ç¯„æœ¬ ",-1))]),e("span",Ol," å·²é¸ "+i(p.value.length)+" å€‹ç­ç´š ",1)]),e("section",null,[s[44]||(s[44]=e("p",{class:"text-xs font-semibold tracking-wide text-base-content/70 uppercase mb-3"}," æ‰¹æ¬¡æ“ä½œ ",-1)),e("div",Vl,[e("label",{class:B(["group cursor-pointer border rounded-2xl p-4 transition-all shadow-sm",{"border-primary bg-primary/5 shadow-[0_12px_24px_rgba(25,39,85,0.12)]":$.value==="template","border-base-300 hover:border-primary/40 hover:bg-base-200/60":$.value!=="template"}])},[E(e("input",{type:"radio",name:"batchAction",value:"template","onUpdate:modelValue":s[7]||(s[7]=o=>$.value=o),class:"sr-only"},null,512),[[be,$.value]]),e("div",Ll,[e("div",zl,[v(m,{name:"Sparkles",class:"w-5 h-5 text-primary"}),s[39]||(s[39]=e("span",{class:"font-semibold"},"å¥—ç”¨ç¯„æœ¬",-1))]),s[40]||(s[40]=e("span",{class:"badge badge-primary badge-outline badge-sm"},"æ¨è–¦",-1))]),s[41]||(s[41]=e("p",{class:"text-sm text-base-content/70 mt-3"}," é¸æ“‡å…¨ç­å”ä½œæˆ–å„çµ„ç¨ç«‹çš„ç¯„æœ¬ï¼Œå¿«é€ŸåŒæ­¥åˆ°æ‰€æœ‰ç­ç´šã€‚ ",-1))],2),e("label",{class:B(["group cursor-pointer border rounded-2xl p-4 transition-all shadow-sm",{"border-error bg-error/5 shadow-[0_12px_24px_rgba(190,46,37,0.12)]":$.value==="disable","border-base-300 hover:border-error/40 hover:bg-error/10":$.value!=="disable"}])},[E(e("input",{type:"radio",name:"batchAction",value:"disable","onUpdate:modelValue":s[8]||(s[8]=o=>$.value=o),class:"sr-only"},null,512),[[be,$.value]]),e("div",Fl,[v(m,{name:"Ban",class:"w-5 h-5 text-error"}),s[42]||(s[42]=e("span",{class:"font-semibold"},"åœç”¨çå‹µ",-1))]),s[43]||(s[43]=e("p",{class:"text-sm text-base-content/70 mt-3"}," åœç”¨å¾Œï¼Œé€™äº›ç­ç´šçš„çå‹µèˆ‡ç„¡æ•µåŠŸèƒ½å°‡ç«‹å³é—œé–‰ã€‚ ",-1))],2)])]),$.value==="template"?(d(),u("section",Gl,[e("div",null,[s[47]||(s[47]=e("p",{class:"text-xs font-semibold tracking-wide text-base-content/70 uppercase mb-2"}," ç¯„æœ¬æ¨¡å¼ ",-1)),e("div",Jl,[e("button",{type:"button",role:"tab","aria-selected":D.value==="class-total",class:B(["flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-semibold transition-all border border-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-primary",{"bg-base-100 text-primary shadow-[0_6px_18px_rgba(25,39,85,0.15)] border-primary/20":D.value==="class-total","text-base-content/60 hover:text-base-content hover:bg-base-100/70":D.value!=="class-total"}]),onClick:s[9]||(s[9]=o=>D.value="class-total")},[v(m,{name:"Users",class:"w-4 h-4"}),s[45]||(s[45]=e("span",null,"å…¨ç­å”ä½œ",-1)),e("span",Wl," ("+i(S.value)+") ",1)],10,Xl),e("button",{type:"button",role:"tab","aria-selected":D.value==="group-based",class:B(["flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-semibold transition-all border border-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-primary",{"bg-base-100 text-primary shadow-[0_6px_18px_rgba(25,39,85,0.15)] border-primary/20":D.value==="group-based","text-base-content/60 hover:text-base-content hover:bg-base-100/70":D.value!=="group-based"}]),onClick:s[10]||(s[10]=o=>D.value="group-based")},[v(m,{name:"Trophy",class:"w-4 h-4"}),s[46]||(s[46]=e("span",null,"å„çµ„ç¨ç«‹",-1)),e("span",Yl," ("+i(h.value)+") ",1)],10,Hl)]),e("p",ql," é¡¯ç¤ºé¸å®šæ¨¡å¼çš„ç¯„æœ¬ï¼Œå…± "+i(F.value.length)+" å€‹é¸é …ã€‚ ",1)]),e("div",null,[s[56]||(s[56]=e("p",{class:"text-sm font-semibold text-base-content"},"é¸æ“‡ç¯„æœ¬",-1)),e("p",Kl," å¥—ç”¨å¾Œå°‡ç«‹å³è¦†å¯«é€™ "+i(p.value.length)+" å€‹ç­ç´šçš„çå‹µè¨­å®šã€‚ ",1),F.value.length===0?(d(),u("div",Ql,[v(m,{name:"PackageSearch",class:"w-8 h-8 mx-auto mb-2 opacity-50"}),s[48]||(s[48]=e("p",null,"é€™å€‹æ¨¡å¼é‚„æ²’æœ‰å¯ç”¨çš„ç¯„æœ¬ï¼Œè«‹å…ˆåœ¨ç¯„æœ¬åº«å»ºç«‹ä¸€å€‹ã€‚",-1))])):(d(),u("div",Zl,[(d(!0),u(j,null,te(F.value,o=>(d(),u("label",{key:o.id,class:B(["flex items-start gap-3 border rounded-2xl p-4 cursor-pointer transition-all",{"border-primary bg-primary/5 shadow-[0_8px_20px_rgba(25,39,85,0.12)]":g.value===o.id,"border-base-300 hover:border-primary/40 hover:bg-base-200/60":g.value!==o.id}])},[E(e("input",{type:"radio",class:"radio radio-primary mt-1",name:"batchTemplate",value:o.id,"onUpdate:modelValue":s[11]||(s[11]=L=>g.value=L)},null,8,en),[[be,g.value]]),e("div",sn,[e("div",tn,[e("span",ln,i(o.name),1),e("span",{class:B(["badge badge-sm",o.settings.mode==="class-total"?"badge-info":"badge-secondary"])},i(o.settings.mode==="class-total"?"å…¨ç­å”ä½œ":"å„çµ„ç¨ç«‹"),3)]),e("ul",nn,[o.settings.mode==="group-based"?(d(),u(j,{key:0},[e("li",an,[s[49]||(s[49]=e("span",{class:"text-base"},"ğŸ’°",-1)),e("span",null,"æ¯é¡†æ˜Ÿ "+i(o.settings.pointsPerStar)+" åˆ†",1)]),e("li",on,[s[50]||(s[50]=e("span",{class:"text-base"},"â­",-1)),e("span",null,"ç„¡æ•µé–€æª» "+i(o.settings.starsToInvincible)+" é¡†æ˜Ÿ",1)]),e("li",rn,[s[51]||(s[51]=e("span",{class:"text-base"},"â±ï¸",-1)),e("span",null," ç„¡æ•µæ™‚é•· "+i(ae(o.settings.invincibleDurationSeconds)),1)]),e("li",dn,[s[52]||(s[52]=e("span",{class:"text-base"},"ğŸ’",-1)),e("span",null,"ç„¡æ•µåŠ åˆ† "+i(o.settings.invinciblePointsPerClick)+" åˆ†/æ¬¡",1)])],64)):(d(),u(j,{key:1},[e("li",cn,[s[53]||(s[53]=e("span",{class:"text-base"},"ğŸ¯",-1)),e("span",null," å…¨ç­ç›®æ¨™ "+i(o.settings.classTotalTargetPoints??o.settings.classTotalMode?.pointsPerInvincible??"â€”")+" åˆ† ",1)]),e("li",un,[s[54]||(s[54]=e("span",{class:"text-base"},"â±ï¸",-1)),e("span",null," ç„¡æ•µæ™‚é•· "+i(ae(o.settings.invincibleDurationSeconds??o.settings.classTotalMode?.invincibleDurationSeconds)),1)]),e("li",pn,[s[55]||(s[55]=e("span",{class:"text-base"},"ğŸ’",-1)),e("span",null," ç„¡æ•µåŠ åˆ† "+i(o.settings.invinciblePointsPerClick??o.settings.classTotalMode?.invinciblePointsPerClick??"â€”")+" åˆ†/æ¬¡ ",1)])],64))])])],2))),128))]))])])):R("",!0),e("div",bn,[v(m,{name:"Info",class:"w-5 h-5 flex-shrink-0"}),e("span",mn,[s[57]||(s[57]=x(" å°‡ ",-1)),$.value==="template"?(d(),u("span",vn,"å¥—ç”¨ç¯„æœ¬")):$.value==="disable"?(d(),u("span",gn,"åœç”¨çå‹µ")):R("",!0),x(" è‡³ "+i(p.value.length)+" å€‹ç­ç´šï¼Œä¿®æ”¹å°‡ç«‹å³ç”Ÿæ•ˆã€‚ ",1)])]),e("div",fn,[e("button",{onClick:ce,class:"btn btn-ghost"},"å–æ¶ˆ"),e("button",{onClick:Pe,class:"btn btn-primary",disabled:$.value==="template"&&!g.value}," ç¢ºèªåŸ·è¡Œ ",8,xn)])])]),e("label",{class:"modal-backdrop",onClick:ce})],2),v(X,{ref_key:"templateModalRef",ref:r,"initial-template":t.value,"is-creating-new":c.value,"default-settings":C.value,onSave:Ue,onCancel:Ee},null,8,["initial-template","is-creating-new","default-settings"]),v(Mt,{ref_key:"confirmDialogRef",ref:oe,title:ie.value,message:ee.value,"confirm-text":"ç¢ºèª","cancel-text":"å–æ¶ˆ",onConfirm:we,onCancel:Te},null,8,["title","message"])])}}}),wn=_e(hn,[["__scopeId","data-v-1538f113"]]);export{wn as default};
