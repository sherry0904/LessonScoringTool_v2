import{f as V,g as F,K as P,M as R,r as h,i as T,j as f,u as j,c as b,l as a,o as c,a as t,b as _,L as D,t as r,F as I,n as U,D as q,w as z,x as A,P as O,e as E,N as H,p as K,m as x,v as g,k as Q,O as G,Q as k}from"#entry";const J={key:0,class:"min-h-screen bg-base-200"},W={class:"bg-base-100 shadow-sm sticky top-0 z-10"},X={class:"container mx-auto px-4 py-2"},Y={class:"flex justify-between items-center"},Z={class:"flex items-center gap-4"},tt={class:"text-xl font-bold text-base-content"},et={class:"text-xs text-base-content/70"},st={class:"tabs tabs-bordered"},nt={class:"hidden sm:inline"},at={class:"container mx-auto px-4 py-6"},ot={class:"modal-box"},lt={class:"text-lg font-bold mb-4"},it={class:"form-control"},dt=["disabled"],ct={class:"form-control"},rt={class:"modal-action"},ut={type:"submit",class:"btn btn-primary"},mt={key:1,class:"min-h-screen flex items-center justify-center"},pt={class:"text-center"},vt=V({__name:"[id]",setup(bt){const u=F(),y=P(),{currentClass:n}=R(u),m=h(),o=h(null),s=T({id:"",name:""}),S=f(()=>{const l=y.params.id;return[{id:"scoring",label:"個人計分",icon:"Star",path:`/class/${l}`},{id:"homework",label:"作業管理",icon:"BookOpen",path:`/class/${l}/homework`},{id:"grouping",label:"分組模式",icon:"Users",path:`/class/${l}/grouping`},{id:"grades",label:"成績結算",icon:"BarChart3",path:`/class/${l}/grades`}]}),w=G(),v=()=>{w.back()},C=()=>{o.value=null,s.id="",s.name="",m.value?.showModal()},M=l=>{const e=n.value?.students.find(d=>d.id===l);e&&(o.value=l,s.id=e.id,s.name=e.name,m.value?.showModal())},$=()=>{if(!s.id.trim()||!s.name.trim()){alert("座號和姓名不能為空！");return}if(n.value){if(o.value)u.updateStudent(n.value.id,o.value,{name:s.name});else{if(n.value.students.some(e=>e.id===s.id)){alert("座號已存在！");return}u.addStudentToClass(n.value.id,s.name,s.id)}p()}},B=()=>{!o.value||!n.value||confirm("確定要刪除此學生嗎？")&&(u.removeStudentFromClass(n.value.id,o.value),p())},p=()=>{m.value?.close(),o.value=null};return j({title:f(()=>n.value?`${n.value.name} - 班級分組計分工具`:"班級管理 - 班級分組計分工具")}),k("addStudent",C),k("editStudent",M),(l,e)=>{const d=D,L=E,N=H;return a(n)?(c(),b("div",J,[t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[t("button",{onClick:v,class:"btn btn-ghost btn-sm gap-2"},[_(d,{name:"ArrowLeft",class:"w-4 h-4"}),e[2]||(e[2]=t("span",{class:"hidden sm:inline"},"返回",-1))]),t("div",null,[t("h1",tt,r(a(n).name),1),t("p",et,r(a(n).students.length)+" 位學生 ",1)])]),t("div",st,[(c(!0),b(I,null,U(a(S),i=>(c(),q(L,{key:i.id,to:i.path,class:A(["tab",{"tab-active":(l._.provides[O]||l.$route).path===i.path}])},{default:z(()=>[_(d,{name:i.icon,class:"w-4 h-4 sm:mr-2"},null,8,["name"]),t("span",nt,r(i.label),1)]),_:2},1032,["to","class"]))),128))])])])]),t("div",at,[_(N)]),t("dialog",{ref_key:"studentModal",ref:m,class:"modal"},[t("div",ot,[t("h3",lt,r(a(o)?"編輯學生":"新增學生"),1),t("form",{onSubmit:K($,["prevent"]),class:"space-y-4"},[t("div",it,[e[3]||(e[3]=t("label",{class:"label mr-2"},[t("span",{class:"label-text"},"座號")],-1)),x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>a(s).id=i),type:"text",placeholder:"例如：01",class:"input input-bordered",disabled:!!a(o),required:""},null,8,dt),[[g,a(s).id]])]),t("div",ct,[e[4]||(e[4]=t("label",{class:"label mr-2"},[t("span",{class:"label-text"},"姓名")],-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>a(s).name=i),type:"text",placeholder:"例如：王小明",class:"input input-bordered",required:""},null,512),[[g,a(s).name]])]),t("div",rt,[a(o)?(c(),b("button",{key:0,type:"button",onClick:B,class:"btn btn-error"}," 刪除學生 ")):Q("",!0),t("button",{type:"button",onClick:p,class:"btn btn-ghost"}," 取消 "),t("button",ut,r(a(o)?"更新":"新增"),1)])],32)]),t("form",{method:"dialog",class:"modal-backdrop"},[t("button",{onClick:p},"close")])],512)])):(c(),b("div",mt,[t("div",pt,[_(d,{name:"AlertCircle",class:"w-16 h-16 mx-auto text-warning mb-4"}),e[5]||(e[5]=t("h2",{class:"text-xl font-semibold mb-2"},"找不到班級",-1)),e[6]||(e[6]=t("p",{class:"text-base-content/70 mb-4"},"請確認網址是否正確，或返回上一頁",-1)),t("button",{onClick:v,class:"btn btn-primary"},"返回上一頁")])]))}}});export{vt as default};
