import{f as C,g as k,D as L,r as b,i,A as T,z,u as H,c as l,o as c,b as h,a as s,k as d,L as I,l as N,s as q,m as M,F as f,n as w,t as n,d as V,q as $,_ as B}from"#entry";import{P as Q}from"./CkQK_kZe.js";const U={class:"p-6 max-w-7xl mx-auto space-y-8"},j={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},F={class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3"},K={class:"relative"},O=["value"],P={class:"flex items-center gap-2"},Z=["value"],E={class:"bg-base-100 rounded-2xl border border-base-300 shadow-sm overflow-hidden"},R={class:"p-4 flex items-center justify-between border-b border-base-300"},W={class:"font-semibold flex items-center gap-2"},X={key:0,class:"max-h-[60vh] overflow-auto custom-scrollbar"},G={class:"table table-zebra"},J=["onClick"],Y={class:"font-medium"},ee={class:"text-center font-mono"},te={class:"hidden md:table-cell"},se={class:"hidden md:table-cell"},ae={key:1,class:"p-10 text-center text-base-content/60"},oe={key:0},le={key:1},ce=C({__name:"students",setup(ne){const u=k(),_=L(),r=b(""),x=[{value:"nameAsc",label:"姓名 (A → Z)"},{value:"nameDesc",label:"姓名 (Z → A)"},{value:"idAsc",label:"座號 (小 → 大)"},{value:"idDesc",label:"座號 (大 → 小)"},{value:"scoreDesc",label:"總分 (高 → 低)"},{value:"scoreAsc",label:"總分 (低 → 高)"},{value:"createdDesc",label:"建立時間 (新 → 舊)"},{value:"createdAsc",label:"建立時間 (舊 → 新)"}],m=b("nameAsc"),g=t=>{r.value=t},p=i(()=>u.classes.flatMap(t=>(t.students||[]).map(e=>({id:e.id,name:e.name,totalScore:e.totalScore||0,classId:t.id,className:t.name,createdAt:new Date(e.createdAt),uniqueKey:`${t.id}-${e.id}`})))),y=i(()=>{const t=r.value.trim().toLowerCase();return t?p.value.filter(e=>e.name.toLowerCase().includes(t)||e.className.toLowerCase().includes(t)||e.id.toLowerCase().includes(t)):p.value}),v=i(()=>{const t=[...y.value];switch(m.value){case"nameAsc":return t.sort((e,a)=>e.name.localeCompare(a.name,"zh-Hant"));case"nameDesc":return t.sort((e,a)=>a.name.localeCompare(e.name,"zh-Hant"));case"idAsc":return t.sort((e,a)=>e.id.localeCompare(a.id,"zh-Hant",{numeric:!0}));case"idDesc":return t.sort((e,a)=>a.id.localeCompare(e.id,"zh-Hant",{numeric:!0}));case"scoreDesc":return t.sort((e,a)=>a.totalScore-e.totalScore);case"scoreAsc":return t.sort((e,a)=>e.totalScore-a.totalScore);case"createdAsc":return t.sort((e,a)=>e.createdAt.getTime()-a.createdAt.getTime());case"createdDesc":default:return t.sort((e,a)=>a.createdAt.getTime()-e.createdAt.getTime())}}),A=i(()=>p.value.length);i(()=>{const t=Date.now()-6048e5;return u.classes.filter(e=>new Date(e.updatedAt).getTime()>t).length}),i(()=>u.totalClasses?Math.round(A.value/u.totalClasses):0);const S=t=>{u.selectClass(t),$(`/class/${t}`)},D=t=>new Date(t).toLocaleDateString("zh-TW",{month:"short",day:"numeric"});return T(()=>{r.value=_.searchQuery||""}),z(r,t=>{_.setSearchQuery(t)}),H({title:"學生管理 - 班級分組計分工具"}),(t,e)=>{const a=I;return c(),l("div",U,[h(Q,{title:"學生管理",description:"跨班級檢視與管理所有學生"}),s("div",j,[s("div",F,[s("div",K,[s("input",{value:d(r),onInput:e[0]||(e[0]=o=>g(o.target.value)),type:"text",placeholder:"搜尋學生、班級或座號...",class:"input input-bordered pl-10 w-full sm:w-72"},null,40,O),h(a,{name:"Search",class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-base-content/50"})]),s("div",P,[e[2]||(e[2]=s("label",{for:"student-sort",class:"text-sm font-semibold whitespace-nowrap"},"排序方式",-1)),N(s("select",{id:"student-sort","onUpdate:modelValue":e[1]||(e[1]=o=>M(m)?m.value=o:null),class:"select select-bordered select-sm sm:select-md"},[(c(),l(f,null,w(x,o=>s("option",{key:o.value,value:o.value},n(o.label),9,Z)),64))],512),[[q,d(m)]])])])]),s("div",E,[s("div",R,[s("h2",W,[h(a,{name:"List",class:"w-5 h-5"}),V(" 全部學生 ("+n(d(v).length)+") ",1)]),e[3]||(e[3]=s("div",{class:"text-sm text-base-content/60"},"點擊學生可快速跳轉至其班級頁面",-1))]),d(v).length?(c(),l("div",X,[s("table",G,[e[4]||(e[4]=s("thead",{class:"sticky top-0 bg-base-200 z-10"},[s("tr",null,[s("th",{class:"w-20"},"座號"),s("th",null,"姓名"),s("th",{class:"w-24 text-center"},"總分"),s("th",{class:"hidden md:table-cell"},"所屬班級"),s("th",{class:"hidden md:table-cell"},"建立時間")])],-1)),s("tbody",null,[(c(!0),l(f,null,w(d(v),o=>(c(),l("tr",{key:o.uniqueKey,class:"hover cursor-pointer",onClick:re=>S(o.classId)},[s("td",null,n(o.id),1),s("td",Y,n(o.name),1),s("td",ee,n(o.totalScore),1),s("td",te,n(o.className),1),s("td",se,n(D(o.createdAt)),1)],8,J))),128))])])])):(c(),l("div",ae,[h(a,{name:"UserX",class:"w-10 h-10 mx-auto mb-4 opacity-50"}),d(r)?(c(),l("p",oe,"找不到符合「"+n(d(r))+"」的學生",1)):(c(),l("p",le,"目前沒有任何學生資料"))]))])])}}}),ue=B(ce,[["__scopeId","data-v-2d67a4de"]]);export{ue as default};
