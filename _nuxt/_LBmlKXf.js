import{f as T,g as j,E as R,G as U,r as h,h as q,i as x,u as z,c as p,k as o,o as c,a as t,b as _,L as A,t as r,F as D,n as E,H,w as P,e as G,I as J,p as K,l as f,v as k,j as O,J as Q,x as W,K as g}from"#entry";const X={key:0,class:"min-h-screen bg-base-200"},Y={class:"bg-base-100 shadow-sm sticky top-0 z-10"},Z={class:"container mx-auto px-4 py-2"},tt={class:"flex justify-between items-center"},et={class:"flex items-center gap-4"},st={class:"text-xl font-bold text-base-content"},nt={class:"text-xs text-base-content/70"},ot={class:"tabs tabs-bordered"},at=["href","onClick"],lt={class:"hidden sm:inline"},it={class:"container mx-auto px-4 py-6"},dt={class:"modal-box"},ct={class:"text-lg font-bold mb-4"},rt={class:"form-control"},ut=["disabled"],mt={class:"form-control"},bt={class:"modal-action"},pt={type:"submit",class:"btn btn-primary"},_t={key:1,class:"min-h-screen flex items-center justify-center"},vt={class:"text-center"},ft=T({__name:"[id]",setup(ht){const u=j(),y=R(),{currentClass:n}=U(u),m=h(),a=h(null),s=q({id:"",name:""}),C=x(()=>{const l=y.params.id;return[{id:"scoring",label:"個人計分",icon:"Star",path:`/class/${l}`},{id:"homework",label:"作業管理",icon:"BookOpen",path:`/class/${l}/homework`},{id:"grouping",label:"分組模式",icon:"Users",path:`/class/${l}/grouping`},{id:"grades",label:"成績結算",icon:"BarChart3",path:`/class/${l}/grades`}]}),S=Q(),v=()=>{S.back()},w=()=>{a.value=null,s.id="",s.name="",m.value?.showModal()},M=l=>{const e=n.value?.students.find(d=>d.id===l);e&&(a.value=l,s.id=e.id,s.name=e.name,m.value?.showModal())},B=()=>{if(!s.id.trim()||!s.name.trim()){alert("座號和姓名不能為空！");return}if(n.value){if(a.value)u.updateStudent(n.value.id,a.value,{name:s.name});else{if(n.value.students.some(e=>e.id===s.id)){alert("座號已存在！");return}u.addStudentToClass(n.value.id,s.name,s.id)}b()}},L=()=>{!a.value||!n.value||confirm("確定要刪除此學生嗎？")&&(u.removeStudentFromClass(n.value.id,a.value),b())},b=()=>{m.value?.close(),a.value=null};return z({title:x(()=>n.value?`${n.value.name} - 班級分組計分工具`:"班級管理 - 班級分組計分工具")}),g("addStudent",w),g("editStudent",M),(l,e)=>{const d=A,$=G,N=J;return o(n)?(c(),p("div",X,[t("div",Y,[t("div",Z,[t("div",tt,[t("div",et,[t("button",{onClick:v,class:"btn btn-ghost btn-sm gap-2"},[_(d,{name:"ArrowLeft",class:"w-4 h-4"}),e[2]||(e[2]=t("span",{class:"hidden sm:inline"},"返回",-1))]),t("div",null,[t("h1",st,r(o(n).name),1),t("p",nt,r(o(n).students.length)+" 位學生 ",1)])]),t("div",ot,[(c(!0),p(D,null,E(o(C),i=>(c(),H($,{key:i.id,to:i.path,custom:""},{default:P(({href:V,navigate:F,isExactActive:I})=>[t("a",{href:V,onClick:F,class:W(["tab",{"tab-active":I}])},[_(d,{name:i.icon,class:"w-4 h-4 sm:mr-2"},null,8,["name"]),t("span",lt,r(i.label),1)],10,at)]),_:2},1032,["to"]))),128))])])])]),t("div",it,[_(N)]),t("dialog",{ref_key:"studentModal",ref:m,class:"modal"},[t("div",dt,[t("h3",ct,r(o(a)?"編輯學生":"新增學生"),1),t("form",{onSubmit:K(B,["prevent"]),class:"space-y-4"},[t("div",rt,[e[3]||(e[3]=t("label",{class:"label mr-2"},[t("span",{class:"label-text"},"座號")],-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>o(s).id=i),type:"text",placeholder:"例如：01",class:"input input-bordered",disabled:!!o(a),required:""},null,8,ut),[[k,o(s).id]])]),t("div",mt,[e[4]||(e[4]=t("label",{class:"label mr-2"},[t("span",{class:"label-text"},"姓名")],-1)),f(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>o(s).name=i),type:"text",placeholder:"例如：王小明",class:"input input-bordered",required:""},null,512),[[k,o(s).name]])]),t("div",bt,[o(a)?(c(),p("button",{key:0,type:"button",onClick:L,class:"btn btn-error"}," 刪除學生 ")):O("",!0),t("button",{type:"button",onClick:b,class:"btn btn-ghost"}," 取消 "),t("button",pt,r(o(a)?"更新":"新增"),1)])],32)]),t("form",{method:"dialog",class:"modal-backdrop"},[t("button",{onClick:b},"close")])],512)])):(c(),p("div",_t,[t("div",vt,[_(d,{name:"AlertCircle",class:"w-16 h-16 mx-auto text-warning mb-4"}),e[5]||(e[5]=t("h2",{class:"text-xl font-semibold mb-2"},"找不到班級",-1)),e[6]||(e[6]=t("p",{class:"text-base-content/70 mb-4"},"請確認網址是否正確，或返回上一頁",-1)),t("button",{onClick:v,class:"btn btn-primary"},"返回上一頁")])]))}}});export{ft as default};
