import{f as U,g as j,B as D,C as I,r as f,h as P,i as h,u as R,c as _,l as o,o as c,a as t,b as r,d as v,L as q,t as u,F as z,n as A,D as E,w as H,e as G,E as O,p as J,k as g,v as k,j as K,G as Q,x as W,H as X}from"#entry";const Y={key:0,class:"min-h-screen bg-base-200"},Z={class:"bg-base-100 shadow-sm sticky top-0 z-10"},tt={class:"container mx-auto px-4 py-4"},et={class:"flex justify-between items-center"},st={class:"flex items-center gap-4"},nt={class:"text-2xl font-bold text-base-content"},ot={class:"text-sm text-base-content/70"},at={class:"flex gap-2"},lt={class:"tabs tabs-bordered mt-4"},it=["href","onClick"],dt={class:"container mx-auto px-4 py-6"},ct={class:"modal-box"},rt={class:"text-lg font-bold mb-4"},ut={class:"form-control"},mt=["disabled"],bt={class:"form-control"},pt={class:"modal-action"},_t={type:"submit",class:"btn btn-primary"},vt={key:1,class:"min-h-screen flex items-center justify-center"},xt={class:"text-center"},gt=U({__name:"[id]",setup(ft){const m=j(),y=D(),{currentClass:n}=I(m),b=f(),a=f(null),s=P({id:"",name:""}),C=h(()=>{const l=y.params.id;return[{id:"scoring",label:"個人計分",icon:"Star",path:`/class/${l}`},{id:"homework",label:"作業管理",icon:"BookOpen",path:`/class/${l}/homework`},{id:"grouping",label:"分組模式",icon:"Users",path:`/class/${l}/grouping`},{id:"grades",label:"成績結算",icon:"BarChart3",path:`/class/${l}/grades`}]}),w=Q(),x=()=>{w.back()},S=()=>{a.value=null,s.id="",s.name="",b.value?.showModal()},B=l=>{const e=n.value?.students.find(d=>d.id===l);e&&(a.value=l,s.id=e.id,s.name=e.name,b.value?.showModal())},M=()=>{if(!s.id.trim()||!s.name.trim()){alert("座號和姓名不能為空！");return}if(n.value){if(a.value)m.updateStudent(n.value.id,a.value,{name:s.name});else{if(n.value.students.some(e=>e.id===s.id)){alert("座號已存在！");return}m.addStudentToClass(n.value.id,s.name,s.id)}p()}},L=()=>{!a.value||!n.value||confirm("確定要刪除此學生嗎？")&&(m.removeStudentFromClass(n.value.id,a.value),p())},p=()=>{b.value?.close(),a.value=null};return R({title:h(()=>n.value?`${n.value.name} - 班級分組計分工具`:"班級管理 - 班級分組計分工具")}),X("editStudent",B),(l,e)=>{const d=q,N=G,V=O;return o(n)?(c(),_("div",Y,[t("div",Z,[t("div",tt,[t("div",et,[t("div",st,[t("button",{onClick:x,class:"btn btn-ghost btn-sm gap-2"},[r(d,{name:"ArrowLeft",class:"w-4 h-4"}),e[2]||(e[2]=v(" 返回上一頁 ",-1))]),t("div",null,[t("h1",nt,u(o(n).name),1),t("p",ot,u(o(n).students.length)+" 位學生 ",1)])]),t("div",at,[t("button",{onClick:S,class:"btn btn-primary btn-sm gap-2"},[r(d,{name:"UserPlus",class:"w-4 h-4"}),e[3]||(e[3]=v(" 新增學生 ",-1))])])]),t("div",lt,[(c(!0),_(z,null,A(o(C),i=>(c(),E(N,{key:i.id,to:i.path,custom:""},{default:H(({href:$,navigate:T,isExactActive:F})=>[t("a",{href:$,onClick:T,class:W(["tab tab-lg",{"tab-active":F}])},[r(d,{name:i.icon,class:"w-4 h-4 mr-2"},null,8,["name"]),v(" "+u(i.label),1)],10,it)]),_:2},1032,["to"]))),128))])])]),t("div",dt,[r(V)]),t("dialog",{ref_key:"studentModal",ref:b,class:"modal"},[t("div",ct,[t("h3",rt,u(o(a)?"編輯學生":"新增學生"),1),t("form",{onSubmit:J(M,["prevent"]),class:"space-y-4"},[t("div",ut,[e[4]||(e[4]=t("label",{class:"label"},[t("span",{class:"label-text"},"座號")],-1)),g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>o(s).id=i),type:"text",placeholder:"例如：01",class:"input input-bordered",disabled:!!o(a),required:""},null,8,mt),[[k,o(s).id]])]),t("div",bt,[e[5]||(e[5]=t("label",{class:"label"},[t("span",{class:"label-text"},"姓名")],-1)),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>o(s).name=i),type:"text",placeholder:"例如：王小明",class:"input input-bordered",required:""},null,512),[[k,o(s).name]])]),t("div",pt,[o(a)?(c(),_("button",{key:0,type:"button",onClick:L,class:"btn btn-error"}," 刪除學生 ")):K("",!0),t("button",{type:"button",onClick:p,class:"btn btn-ghost"}," 取消 "),t("button",_t,u(o(a)?"更新":"新增"),1)])],32)]),t("form",{method:"dialog",class:"modal-backdrop"},[t("button",{onClick:p},"close")])],512)])):(c(),_("div",vt,[t("div",xt,[r(d,{name:"AlertCircle",class:"w-16 h-16 mx-auto text-warning mb-4"}),e[6]||(e[6]=t("h2",{class:"text-xl font-semibold mb-2"},"找不到班級",-1)),e[7]||(e[7]=t("p",{class:"text-base-content/70 mb-4"},"請確認網址是否正確，或返回上一頁",-1)),t("button",{onClick:x,class:"btn btn-primary"},"返回上一頁")])]))}}});export{gt as default};
