import{f as C,g as k,D as L,r as _,i,A as T,z,u as I,c as l,o as n,a as s,b,k as d,L as N,l as H,s as q,m as M,F as f,n as x,t as c,d as V,q as $,_ as B}from"#entry";const Q={class:"p-6 max-w-7xl mx-auto space-y-8"},U={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},j={class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3"},F={class:"relative"},K=["value"],O={class:"flex items-center gap-2"},Z=["value"],E={class:"bg-base-100 rounded-2xl border border-base-300 shadow-sm overflow-hidden"},R={class:"p-4 flex items-center justify-between border-b border-base-300"},W={class:"font-semibold flex items-center gap-2"},X={key:0,class:"max-h-[60vh] overflow-auto custom-scrollbar"},G={class:"table table-zebra"},J=["onClick"],P={class:"font-medium"},Y={class:"text-center font-mono"},ee={class:"hidden md:table-cell"},te={class:"hidden md:table-cell"},se={key:1,class:"p-10 text-center text-base-content/60"},ae={key:0},oe={key:1},le=C({__name:"students",setup(ne){const u=k(),v=L(),r=_(""),w=[{value:"nameAsc",label:"姓名 (A → Z)"},{value:"nameDesc",label:"姓名 (Z → A)"},{value:"idAsc",label:"座號 (小 → 大)"},{value:"idDesc",label:"座號 (大 → 小)"},{value:"scoreDesc",label:"總分 (高 → 低)"},{value:"scoreAsc",label:"總分 (低 → 高)"},{value:"createdDesc",label:"建立時間 (新 → 舊)"},{value:"createdAsc",label:"建立時間 (舊 → 新)"}],m=_("nameAsc"),g=t=>{r.value=t},h=i(()=>u.classes.flatMap(t=>(t.students||[]).map(e=>({id:e.id,name:e.name,totalScore:e.totalScore||0,classId:t.id,className:t.name,createdAt:new Date(e.createdAt),uniqueKey:`${t.id}-${e.id}`})))),y=i(()=>{const t=r.value.trim().toLowerCase();return t?h.value.filter(e=>e.name.toLowerCase().includes(t)||e.className.toLowerCase().includes(t)||e.id.toLowerCase().includes(t)):h.value}),p=i(()=>{const t=[...y.value];switch(m.value){case"nameAsc":return t.sort((e,a)=>e.name.localeCompare(a.name,"zh-Hant"));case"nameDesc":return t.sort((e,a)=>a.name.localeCompare(e.name,"zh-Hant"));case"idAsc":return t.sort((e,a)=>e.id.localeCompare(a.id,"zh-Hant",{numeric:!0}));case"idDesc":return t.sort((e,a)=>a.id.localeCompare(e.id,"zh-Hant",{numeric:!0}));case"scoreDesc":return t.sort((e,a)=>a.totalScore-e.totalScore);case"scoreAsc":return t.sort((e,a)=>e.totalScore-a.totalScore);case"createdAsc":return t.sort((e,a)=>e.createdAt.getTime()-a.createdAt.getTime());case"createdDesc":default:return t.sort((e,a)=>a.createdAt.getTime()-e.createdAt.getTime())}}),A=i(()=>h.value.length);i(()=>{const t=Date.now()-6048e5;return u.classes.filter(e=>new Date(e.updatedAt).getTime()>t).length}),i(()=>u.totalClasses?Math.round(A.value/u.totalClasses):0);const S=t=>{u.selectClass(t),$(`/class/${t}`)},D=t=>new Date(t).toLocaleDateString("zh-TW",{month:"short",day:"numeric"});return T(()=>{r.value=v.searchQuery||""}),z(r,t=>{v.setSearchQuery(t)}),I({title:"學生管理 - 班級分組計分工具"}),(t,e)=>{const a=N;return n(),l("div",Q,[s("div",U,[e[3]||(e[3]=s("div",null,[s("h1",{class:"text-3xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent"}," 學生管理 "),s("p",{class:"text-base-content/70 mt-2"},"跨班級檢視與管理所有學生")],-1)),s("div",j,[s("div",F,[s("input",{value:d(r),onInput:e[0]||(e[0]=o=>g(o.target.value)),type:"text",placeholder:"搜尋學生、班級或座號...",class:"input input-bordered pl-10 w-full sm:w-72"},null,40,K),b(a,{name:"Search",class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-base-content/50"})]),s("div",O,[e[2]||(e[2]=s("label",{for:"student-sort",class:"text-sm font-semibold whitespace-nowrap"},"排序方式",-1)),H(s("select",{id:"student-sort","onUpdate:modelValue":e[1]||(e[1]=o=>M(m)?m.value=o:null),class:"select select-bordered select-sm sm:select-md"},[(n(),l(f,null,x(w,o=>s("option",{key:o.value,value:o.value},c(o.label),9,Z)),64))],512),[[q,d(m)]])])])]),s("div",E,[s("div",R,[s("h2",W,[b(a,{name:"List",class:"w-5 h-5"}),V(" 全部學生 ("+c(d(p).length)+") ",1)]),e[4]||(e[4]=s("div",{class:"text-sm text-base-content/60"},"點擊學生可快速跳轉至其班級頁面",-1))]),d(p).length?(n(),l("div",X,[s("table",G,[e[5]||(e[5]=s("thead",{class:"sticky top-0 bg-base-200 z-10"},[s("tr",null,[s("th",{class:"w-20"},"座號"),s("th",null,"姓名"),s("th",{class:"w-24 text-center"},"總分"),s("th",{class:"hidden md:table-cell"},"所屬班級"),s("th",{class:"hidden md:table-cell"},"建立時間")])],-1)),s("tbody",null,[(n(!0),l(f,null,x(d(p),o=>(n(),l("tr",{key:o.uniqueKey,class:"hover cursor-pointer",onClick:ce=>S(o.classId)},[s("td",null,c(o.id),1),s("td",P,c(o.name),1),s("td",Y,c(o.totalScore),1),s("td",ee,c(o.className),1),s("td",te,c(D(o.createdAt)),1)],8,J))),128))])])])):(n(),l("div",se,[b(a,{name:"UserX",class:"w-10 h-10 mx-auto mb-4 opacity-50"}),d(r)?(n(),l("p",ae,"找不到符合「"+c(d(r))+"」的學生",1)):(n(),l("p",oe,"目前沒有任何學生資料"))]))])])}}}),de=B(le,[["__scopeId","data-v-20bf538d"]]);export{de as default};
